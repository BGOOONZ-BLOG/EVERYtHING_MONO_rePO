{"expireTime":9007200896510344000,"key":"childBlockNodes-c0e1786f-a24c-5cb8-8f6d-ac33c4b0dfed-09f76177c339aa0373eb9a4c9ce4c0ba","val":[{"index":0,"text":"import numpy as np\nimport plotly.graph_objects as go\nimport tensorflow as tf\nimport tensorflow_probability as tfp\n\ntfd = tfp.distributions\n\nnormals_2d = [\n    tfd.MultivariateNormalDiag([2, -2]),\n    tfd.MultivariateNormalDiag([-2, 2]),\n]\nbimodal = tfd.Mixture(tfd.Categorical([0.5, 0.5]), normals_2d)\n\n\n@tf.function(experimental_compile=True)\ndef sample_chain(*args, **kwargs):\n    \"\"\"@tf.function JIT-compiles a static graph for tfp.mcmc.sample_chain.\n    This significantly improves performance, especially when enabling XLA.\n    https://tensorflow.org/xla#explicit_compilation_with_tffunction\n    https://github.com/tensorflow/probability/issues/728#issuecomment-573704750\n    \"\"\"\n    return tfp.mcmc.sample_chain(*args, **kwargs)\n\n\nstep_size = 1e-3\nkernel = tfp.mcmc.NoUTurnSampler(bimodal.log_prob, step_size=step_size)\nadaptive_kernel = tfp.mcmc.DualAveragingStepSizeAdaptation(\n    kernel,\n    num_adaptation_steps=500,\n    # pkr: previous kernel results, new_ss: new step size\n    step_size_setter_fn=lambda pkr, new_ss: pkr._replace(step_size=new_ss),\n    step_size_getter_fn=lambda pkr: pkr.step_size,\n    log_accept_prob_getter_fn=lambda pkr: pkr.log_accept_ratio,\n)\nchain, trace, final_kernel_results = sample_chain(\n    kernel=adaptive_kernel,\n    num_results=200,\n    current_state=tf.constant([0.1, 0]),\n    return_final_kernel_results=True,\n)\n\nxr = np.linspace(-6, 6, 13)\ndomain = np.stack(np.meshgrid(xr, xr), -1).reshape(-1, 2)\n\ndensity_plot = go.Surface(\n    x=xr, y=xr, z=bimodal.prob(domain).numpy().reshape(len(xr), -1)\n)\nsamples_plot = go.Scatter3d(x=chain[:, 0], y=chain[:, 1], z=bimodal.prob(chain))\n\nfig = go.Figure(data=[density_plot, samples_plot])\nfig.update_layout(height=700, title_text=f\"step size: {step_size}\")","meta":{},"html":"<pre class=\"grvsc-container default-dark\" data-language=\"py\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> numpy </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> np</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> plotly.graph_objects </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> go</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow_probability </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tfp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">tfd = tfp.distributions</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">normals_2d = [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tfd.MultivariateNormalDiag([</span><span class=\"mtk7\">2</span><span class=\"mtk1\">, -</span><span class=\"mtk7\">2</span><span class=\"mtk1\">]),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tfd.MultivariateNormalDiag([-</span><span class=\"mtk7\">2</span><span class=\"mtk1\">, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">]),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bimodal = tfd.Mixture(tfd.Categorical([</span><span class=\"mtk7\">0.5</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.5</span><span class=\"mtk1\">]), normals_2d)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">@tf.function</span><span class=\"mtk1\">(</span><span class=\"mtk12\">experimental_compile</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">sample_chain</span><span class=\"mtk1\">(*</span><span class=\"mtk12\">args</span><span class=\"mtk1\">, **</span><span class=\"mtk12\">kwargs</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;@tf.function JIT-compiles a static graph for tfp.mcmc.sample_chain.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    This significantly improves performance, especially when enabling XLA.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    https://tensorflow.org/xla#explicit_compilation_with_tffunction</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    https://github.com/tensorflow/probability/issues/728#issuecomment-573704750</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tfp.mcmc.sample_chain(*args, **kwargs)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">step_size = </span><span class=\"mtk7\">1e-3</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">kernel = tfp.mcmc.NoUTurnSampler(bimodal.log_prob, </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=step_size)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">adaptive_kernel = tfp.mcmc.DualAveragingStepSizeAdaptation(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    kernel,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_adaptation_steps</span><span class=\"mtk1\">=</span><span class=\"mtk7\">500</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># pkr: previous kernel results, new_ss: new step size</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">step_size_setter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">, </span><span class=\"mtk12\">new_ss</span><span class=\"mtk1\">: pkr._replace(</span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=new_ss),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">step_size_getter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">: pkr.step_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">log_accept_prob_getter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">: pkr.log_accept_ratio,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">chain, trace, final_kernel_results = sample_chain(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">kernel</span><span class=\"mtk1\">=adaptive_kernel,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_results</span><span class=\"mtk1\">=</span><span class=\"mtk7\">200</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">=tf.constant([</span><span class=\"mtk7\">0.1</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">]),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">return_final_kernel_results</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">xr = np.linspace(-</span><span class=\"mtk7\">6</span><span class=\"mtk1\">, </span><span class=\"mtk7\">6</span><span class=\"mtk1\">, </span><span class=\"mtk7\">13</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">domain = np.stack(np.meshgrid(xr, xr), -</span><span class=\"mtk7\">1</span><span class=\"mtk1\">).reshape(-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">density_plot = go.Surface(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">x</span><span class=\"mtk1\">=xr, </span><span class=\"mtk12\">y</span><span class=\"mtk1\">=xr, </span><span class=\"mtk12\">z</span><span class=\"mtk1\">=bimodal.prob(domain).numpy().reshape(</span><span class=\"mtk11\">len</span><span class=\"mtk1\">(xr), -</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">samples_plot = go.Scatter3d(</span><span class=\"mtk12\">x</span><span class=\"mtk1\">=chain[:, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">], </span><span class=\"mtk12\">y</span><span class=\"mtk1\">=chain[:, </span><span class=\"mtk7\">1</span><span class=\"mtk1\">], </span><span class=\"mtk12\">z</span><span class=\"mtk1\">=bimodal.prob(chain))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">fig = go.Figure(</span><span class=\"mtk12\">data</span><span class=\"mtk1\">=[density_plot, samples_plot])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">fig.update_layout(</span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk7\">700</span><span class=\"mtk1\">, </span><span class=\"mtk12\">title_text</span><span class=\"mtk1\">=</span><span class=\"mtk4\">f</span><span class=\"mtk8\">&quot;step size: </span><span class=\"mtk4\">{</span><span class=\"mtk1\">step_size</span><span class=\"mtk4\">}</span><span class=\"mtk8\">&quot;</span><span class=\"mtk1\">)</span></span></span></code></pre>","preClassName":"grvsc-container default-dark","codeClassName":"grvsc-code","language":"py","defaultTheme":{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]},"additionalThemes":[{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]}],"tokenizedLines":[{"text":"import numpy as np","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"numpy","startIndex":7,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">numpy</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":13,"endIndex":15,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"np","startIndex":16,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">np</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> numpy </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> np</span></span></span>"},{"text":"import plotly.graph_objects as go","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"plotly","startIndex":7,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">plotly</span>"},{"text":".","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"graph_objects","startIndex":14,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">graph_objects</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":28,"endIndex":30,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"go","startIndex":31,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">go</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> plotly.graph_objects </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> go</span></span></span>"},{"text":"import tensorflow as tf","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow","startIndex":7,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":18,"endIndex":20,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":21,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>"},{"text":"import tensorflow_probability as tfp","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow_probability","startIndex":7,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow_probability</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":30,"endIndex":32,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":32,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":33,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow_probability </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tfp</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"tfd = tfp.distributions","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"tfd","startIndex":0,"endIndex":3,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfd</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":4,"endIndex":5,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":5,"endIndex":6,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":6,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":9,"endIndex":10,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"distributions","startIndex":10,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">distributions</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">tfd = tfp.distributions</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"normals_2d = [","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"normals_2d","startIndex":0,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">normals_2d</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":11,"endIndex":12,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">normals_2d = [</span></span></span>"},{"text":"    tfd.MultivariateNormalDiag([2, -2]),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"tfd","startIndex":4,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfd</span>"},{"text":".","startIndex":7,"endIndex":8,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"MultivariateNormalDiag","startIndex":8,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">MultivariateNormalDiag</span>"},{"text":"(","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"[","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"2","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":",","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"-","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"2","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":"]","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":39,"endIndex":40,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tfd.MultivariateNormalDiag([</span><span class=\"mtk7\">2</span><span class=\"mtk1\">, -</span><span class=\"mtk7\">2</span><span class=\"mtk1\">]),</span></span></span>"},{"text":"    tfd.MultivariateNormalDiag([-2, 2]),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"tfd","startIndex":4,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfd</span>"},{"text":".","startIndex":7,"endIndex":8,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"MultivariateNormalDiag","startIndex":8,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">MultivariateNormalDiag</span>"},{"text":"(","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"[","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"-","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"2","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":",","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"2","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":"]","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":39,"endIndex":40,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tfd.MultivariateNormalDiag([-</span><span class=\"mtk7\">2</span><span class=\"mtk1\">, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">]),</span></span></span>"},{"text":"]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"]","startIndex":0,"endIndex":1,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">]</span></span></span>"},{"text":"bimodal = tfd.Mixture(tfd.Categorical([0.5, 0.5]), normals_2d)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"bimodal","startIndex":0,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bimodal</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":8,"endIndex":9,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfd","startIndex":10,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfd</span>"},{"text":".","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Mixture","startIndex":14,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Mixture</span>"},{"text":"(","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"tfd","startIndex":22,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfd</span>"},{"text":".","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Categorical","startIndex":26,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Categorical</span>"},{"text":"(","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"[","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"0.5","startIndex":39,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.5</span>"},{"text":",","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0.5","startIndex":44,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.5</span>"},{"text":"]","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"normals_2d","startIndex":51,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">normals_2d</span>"},{"text":")","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bimodal = tfd.Mixture(tfd.Categorical([</span><span class=\"mtk7\">0.5</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.5</span><span class=\"mtk1\">]), normals_2d)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"@tf.function(experimental_compile=True)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"@","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python","punctuation.definition.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">@</span>"},{"text":"tf","startIndex":1,"endIndex":3,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">tf</span>"},{"text":".","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">.</span>"},{"text":"function","startIndex":4,"endIndex":12,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">function</span>"},{"text":"(","startIndex":12,"endIndex":13,"scopes":["source.python","meta.function.decorator.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"experimental_compile","startIndex":13,"endIndex":33,"scopes":["source.python","meta.function.decorator.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">experimental_compile</span>"},{"text":"=","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function.decorator.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"True","startIndex":34,"endIndex":38,"scopes":["source.python","meta.function.decorator.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">True</span>"},{"text":")","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function.decorator.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">@tf.function</span><span class=\"mtk1\">(</span><span class=\"mtk12\">experimental_compile</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">)</span></span></span>"},{"text":"def sample_chain(*args, **kwargs):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"sample_chain","startIndex":4,"endIndex":16,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">sample_chain</span>"},{"text":"(","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.unpacking.parameter.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"args","startIndex":18,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">args</span>"},{"text":",","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"**","startIndex":24,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.unpacking.parameter.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">**</span>"},{"text":"kwargs","startIndex":26,"endIndex":32,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">kwargs</span>"},{"text":")","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">sample_chain</span><span class=\"mtk1\">(*</span><span class=\"mtk12\">args</span><span class=\"mtk1\">, **</span><span class=\"mtk12\">kwargs</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    \"\"\"@tf.function JIT-compiles a static graph for tfp.mcmc.sample_chain.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"@tf.function JIT-compiles a static graph for tfp.mcmc.sample_chain.","startIndex":7,"endIndex":75,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">@tf.function JIT-compiles a static graph for tfp.mcmc.sample_chain.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;@tf.function JIT-compiles a static graph for tfp.mcmc.sample_chain.</span></span></span>"},{"text":"    This significantly improves performance, especially when enabling XLA.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    This significantly improves performance, especially when enabling XLA.","startIndex":0,"endIndex":75,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    This significantly improves performance, especially when enabling XLA.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    This significantly improves performance, especially when enabling XLA.</span></span></span>"},{"text":"    https://tensorflow.org/xla#explicit_compilation_with_tffunction","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    https://tensorflow.org/xla#explicit_compilation_with_tffunction","startIndex":0,"endIndex":68,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    https://tensorflow.org/xla#explicit_compilation_with_tffunction</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    https://tensorflow.org/xla#explicit_compilation_with_tffunction</span></span></span>"},{"text":"    https://github.com/tensorflow/probability/issues/728#issuecomment-573704750","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    https://github.com/tensorflow/probability/issues/728#issuecomment-573704750","startIndex":0,"endIndex":80,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    https://github.com/tensorflow/probability/issues/728#issuecomment-573704750</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    https://github.com/tensorflow/probability/issues/728#issuecomment-573704750</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    return tfp.mcmc.sample_chain(*args, **kwargs)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":11,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":15,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"sample_chain","startIndex":20,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sample_chain</span>"},{"text":"(","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"args","startIndex":34,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">args</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"**","startIndex":40,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">**</span>"},{"text":"kwargs","startIndex":42,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kwargs</span>"},{"text":")","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tfp.mcmc.sample_chain(*args, **kwargs)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"step_size = 1e-3","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"step_size","startIndex":0,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":10,"endIndex":11,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"1e-3","startIndex":12,"endIndex":16,"scopes":["source.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1e-3</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">step_size = </span><span class=\"mtk7\">1e-3</span></span></span>"},{"text":"kernel = tfp.mcmc.NoUTurnSampler(bimodal.log_prob, step_size=step_size)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"kernel","startIndex":0,"endIndex":6,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":7,"endIndex":8,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":9,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":12,"endIndex":13,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":13,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":17,"endIndex":18,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"NoUTurnSampler","startIndex":18,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">NoUTurnSampler</span>"},{"text":"(","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"bimodal","startIndex":33,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bimodal</span>"},{"text":".","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"log_prob","startIndex":41,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":",","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"step_size","startIndex":51,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size</span>"},{"text":"=","startIndex":60,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"step_size","startIndex":61,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size</span>"},{"text":")","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">kernel = tfp.mcmc.NoUTurnSampler(bimodal.log_prob, </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=step_size)</span></span></span>"},{"text":"adaptive_kernel = tfp.mcmc.DualAveragingStepSizeAdaptation(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"adaptive_kernel","startIndex":0,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">adaptive_kernel</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":16,"endIndex":17,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":18,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":21,"endIndex":22,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":22,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":26,"endIndex":27,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"DualAveragingStepSizeAdaptation","startIndex":27,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">DualAveragingStepSizeAdaptation</span>"},{"text":"(","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">adaptive_kernel = tfp.mcmc.DualAveragingStepSizeAdaptation(</span></span></span>"},{"text":"    kernel,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"kernel","startIndex":4,"endIndex":10,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel</span>"},{"text":",","startIndex":10,"endIndex":11,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    kernel,</span></span></span>"},{"text":"    num_adaptation_steps=500,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"num_adaptation_steps","startIndex":4,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_adaptation_steps</span>"},{"text":"=","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"500","startIndex":25,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">500</span>"},{"text":",","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_adaptation_steps</span><span class=\"mtk1\">=</span><span class=\"mtk7\">500</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    # pkr: previous kernel results, new_ss: new step size","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"#","startIndex":4,"endIndex":5,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" pkr: previous kernel results, new_ss: new step size","startIndex":5,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> pkr: previous kernel results, new_ss: new step size</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># pkr: previous kernel results, new_ss: new step size</span></span></span>"},{"text":"    step_size_setter_fn=lambda pkr, new_ss: pkr._replace(step_size=new_ss),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"step_size_setter_fn","startIndex":4,"endIndex":23,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size_setter_fn</span>"},{"text":"=","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"lambda","startIndex":24,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":31,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">pkr</span>"},{"text":",","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"new_ss","startIndex":36,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">new_ss</span>"},{"text":":","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":44,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">pkr</span>"},{"text":".","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"_replace","startIndex":48,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">_replace</span>"},{"text":"(","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"step_size","startIndex":57,"endIndex":66,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size</span>"},{"text":"=","startIndex":66,"endIndex":67,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"new_ss","startIndex":67,"endIndex":73,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">new_ss</span>"},{"text":")","startIndex":73,"endIndex":74,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":74,"endIndex":75,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">step_size_setter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">, </span><span class=\"mtk12\">new_ss</span><span class=\"mtk1\">: pkr._replace(</span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=new_ss),</span></span></span>"},{"text":"    step_size_getter_fn=lambda pkr: pkr.step_size,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"step_size_getter_fn","startIndex":4,"endIndex":23,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size_getter_fn</span>"},{"text":"=","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"lambda","startIndex":24,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":31,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">pkr</span>"},{"text":":","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":36,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">pkr</span>"},{"text":".","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"step_size","startIndex":40,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size</span>"},{"text":",","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">step_size_getter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">: pkr.step_size,</span></span></span>"},{"text":"    log_accept_prob_getter_fn=lambda pkr: pkr.log_accept_ratio,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"log_accept_prob_getter_fn","startIndex":4,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">log_accept_prob_getter_fn</span>"},{"text":"=","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"lambda","startIndex":30,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":37,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">pkr</span>"},{"text":":","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":42,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">pkr</span>"},{"text":".","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"log_accept_ratio","startIndex":46,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_accept_ratio</span>"},{"text":",","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">log_accept_prob_getter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">: pkr.log_accept_ratio,</span></span></span>"},{"text":")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>"},{"text":"chain, trace, final_kernel_results = sample_chain(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"chain","startIndex":0,"endIndex":5,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":",","startIndex":5,"endIndex":6,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"trace","startIndex":7,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":",","startIndex":12,"endIndex":13,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":13,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"final_kernel_results","startIndex":14,"endIndex":34,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">final_kernel_results</span>"},{"text":" ","startIndex":34,"endIndex":35,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":35,"endIndex":36,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":36,"endIndex":37,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"sample_chain","startIndex":37,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sample_chain</span>"},{"text":"(","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">chain, trace, final_kernel_results = sample_chain(</span></span></span>"},{"text":"    kernel=adaptive_kernel,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"kernel","startIndex":4,"endIndex":10,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">kernel</span>"},{"text":"=","startIndex":10,"endIndex":11,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"adaptive_kernel","startIndex":11,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">adaptive_kernel</span>"},{"text":",","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">kernel</span><span class=\"mtk1\">=adaptive_kernel,</span></span></span>"},{"text":"    num_results=200,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"num_results","startIndex":4,"endIndex":15,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_results</span>"},{"text":"=","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"200","startIndex":16,"endIndex":19,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">200</span>"},{"text":",","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_results</span><span class=\"mtk1\">=</span><span class=\"mtk7\">200</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    current_state=tf.constant([0.1, 0]),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"current_state","startIndex":4,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">current_state</span>"},{"text":"=","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"tf","startIndex":18,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"constant","startIndex":21,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">constant</span>"},{"text":"(","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"[","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"0.1","startIndex":31,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.1</span>"},{"text":",","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":"]","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">=tf.constant([</span><span class=\"mtk7\">0.1</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">]),</span></span></span>"},{"text":"    return_final_kernel_results=True,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return_final_kernel_results","startIndex":4,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">return_final_kernel_results</span>"},{"text":"=","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"True","startIndex":32,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">True</span>"},{"text":",","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">return_final_kernel_results</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">,</span></span></span>"},{"text":")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"xr = np.linspace(-6, 6, 13)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"xr","startIndex":0,"endIndex":2,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">xr</span>"},{"text":" ","startIndex":2,"endIndex":3,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":3,"endIndex":4,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":4,"endIndex":5,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"np","startIndex":5,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">np</span>"},{"text":".","startIndex":7,"endIndex":8,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"linspace","startIndex":8,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">linspace</span>"},{"text":"(","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"-","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"6","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">6</span>"},{"text":",","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"6","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">6</span>"},{"text":",","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"13","startIndex":24,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">13</span>"},{"text":")","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">xr = np.linspace(-</span><span class=\"mtk7\">6</span><span class=\"mtk1\">, </span><span class=\"mtk7\">6</span><span class=\"mtk1\">, </span><span class=\"mtk7\">13</span><span class=\"mtk1\">)</span></span></span>"},{"text":"domain = np.stack(np.meshgrid(xr, xr), -1).reshape(-1, 2)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"domain","startIndex":0,"endIndex":6,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">domain</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":7,"endIndex":8,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"np","startIndex":9,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">np</span>"},{"text":".","startIndex":11,"endIndex":12,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"stack","startIndex":12,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">stack</span>"},{"text":"(","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"np","startIndex":18,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">np</span>"},{"text":".","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"meshgrid","startIndex":21,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">meshgrid</span>"},{"text":"(","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"xr","startIndex":30,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">xr</span>"},{"text":",","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"xr","startIndex":34,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">xr</span>"},{"text":")","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"-","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":")","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":".","startIndex":42,"endIndex":43,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"reshape","startIndex":43,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">reshape</span>"},{"text":"(","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"-","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":",","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"2","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":")","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">domain = np.stack(np.meshgrid(xr, xr), -</span><span class=\"mtk7\">1</span><span class=\"mtk1\">).reshape(-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"density_plot = go.Surface(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"density_plot","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">density_plot</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":13,"endIndex":14,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"go","startIndex":15,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">go</span>"},{"text":".","startIndex":17,"endIndex":18,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Surface","startIndex":18,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Surface</span>"},{"text":"(","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">density_plot = go.Surface(</span></span></span>"},{"text":"    x=xr, y=xr, z=bimodal.prob(domain).numpy().reshape(len(xr), -1)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"x","startIndex":4,"endIndex":5,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">x</span>"},{"text":"=","startIndex":5,"endIndex":6,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"xr","startIndex":6,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">xr</span>"},{"text":",","startIndex":8,"endIndex":9,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y","startIndex":10,"endIndex":11,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">y</span>"},{"text":"=","startIndex":11,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"xr","startIndex":12,"endIndex":14,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">xr</span>"},{"text":",","startIndex":14,"endIndex":15,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"z","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">z</span>"},{"text":"=","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"bimodal","startIndex":18,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bimodal</span>"},{"text":".","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"prob","startIndex":26,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prob</span>"},{"text":"(","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"domain","startIndex":31,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">domain</span>"},{"text":")","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":".","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"numpy","startIndex":39,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">numpy</span>"},{"text":"(","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":".","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"reshape","startIndex":47,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">reshape</span>"},{"text":"(","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"len","startIndex":55,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">len</span>"},{"text":"(","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"xr","startIndex":59,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">xr</span>"},{"text":")","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"-","startIndex":64,"endIndex":65,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":65,"endIndex":66,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":")","startIndex":66,"endIndex":67,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">x</span><span class=\"mtk1\">=xr, </span><span class=\"mtk12\">y</span><span class=\"mtk1\">=xr, </span><span class=\"mtk12\">z</span><span class=\"mtk1\">=bimodal.prob(domain).numpy().reshape(</span><span class=\"mtk11\">len</span><span class=\"mtk1\">(xr), -</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)</span></span></span>"},{"text":")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>"},{"text":"samples_plot = go.Scatter3d(x=chain[:, 0], y=chain[:, 1], z=bimodal.prob(chain))","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"samples_plot","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">samples_plot</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":13,"endIndex":14,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"go","startIndex":15,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">go</span>"},{"text":".","startIndex":17,"endIndex":18,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Scatter3d","startIndex":18,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Scatter3d</span>"},{"text":"(","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"x","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">x</span>"},{"text":"=","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"chain","startIndex":30,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":"[","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":":","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.slice.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":",","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":"]","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":",","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">y</span>"},{"text":"=","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"chain","startIndex":45,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":"[","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":":","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.slice.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":",","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"1","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":"]","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":",","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"z","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">z</span>"},{"text":"=","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"bimodal","startIndex":60,"endIndex":67,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bimodal</span>"},{"text":".","startIndex":67,"endIndex":68,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"prob","startIndex":68,"endIndex":72,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prob</span>"},{"text":"(","startIndex":72,"endIndex":73,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"chain","startIndex":73,"endIndex":78,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":")","startIndex":78,"endIndex":79,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":79,"endIndex":80,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">samples_plot = go.Scatter3d(</span><span class=\"mtk12\">x</span><span class=\"mtk1\">=chain[:, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">], </span><span class=\"mtk12\">y</span><span class=\"mtk1\">=chain[:, </span><span class=\"mtk7\">1</span><span class=\"mtk1\">], </span><span class=\"mtk12\">z</span><span class=\"mtk1\">=bimodal.prob(chain))</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"fig = go.Figure(data=[density_plot, samples_plot])","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"fig","startIndex":0,"endIndex":3,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">fig</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":4,"endIndex":5,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":5,"endIndex":6,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"go","startIndex":6,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">go</span>"},{"text":".","startIndex":8,"endIndex":9,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Figure","startIndex":9,"endIndex":15,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Figure</span>"},{"text":"(","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"data","startIndex":16,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">data</span>"},{"text":"=","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"[","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"density_plot","startIndex":22,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">density_plot</span>"},{"text":",","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"samples_plot","startIndex":36,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">samples_plot</span>"},{"text":"]","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">fig = go.Figure(</span><span class=\"mtk12\">data</span><span class=\"mtk1\">=[density_plot, samples_plot])</span></span></span>"},{"text":"fig.update_layout(height=700, title_text=f\"step size: {step_size}\")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"fig","startIndex":0,"endIndex":3,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">fig</span>"},{"text":".","startIndex":3,"endIndex":4,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"update_layout","startIndex":4,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">update_layout</span>"},{"text":"(","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"height","startIndex":18,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">height</span>"},{"text":"=","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"700","startIndex":25,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">700</span>"},{"text":",","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"title_text","startIndex":30,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">title_text</span>"},{"text":"=","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"f","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.fstring.python","string.interpolated.python","string.quoted.single.python","storage.type.string.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16843306,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">f</span>"},{"text":"\"","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.fstring.python","punctuation.definition.string.begin.python","string.interpolated.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"step size: ","startIndex":43,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.fstring.python","string.interpolated.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">step size: </span>"},{"text":"{","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.fstring.python","constant.character.format.placeholder.other.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">{</span>"},{"text":"step_size","startIndex":55,"endIndex":64,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.fstring.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size</span>"},{"text":"}","startIndex":64,"endIndex":65,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.fstring.python","constant.character.format.placeholder.other.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">}</span>"},{"text":"\"","startIndex":65,"endIndex":66,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.fstring.python","punctuation.definition.string.end.python","string.interpolated.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":")","startIndex":66,"endIndex":67,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">fig.update_layout(</span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk7\">700</span><span class=\"mtk1\">, </span><span class=\"mtk12\">title_text</span><span class=\"mtk1\">=</span><span class=\"mtk4\">f</span><span class=\"mtk8\">&quot;step size: </span><span class=\"mtk4\">{</span><span class=\"mtk1\">step_size</span><span class=\"mtk4\">}</span><span class=\"mtk8\">&quot;</span><span class=\"mtk1\">)</span></span></span>"}],"id":"90fed34d-7528-5854-828c-fa745b628805","parent":"c0e1786f-a24c-5cb8-8f6d-ac33c4b0dfed","internal":{"type":"GRVSCCodeBlock","contentDigest":"c5d9755b6b2f59b74898ad229730c48a","counter":1025,"owner":"gatsby-plugin-mdx"},"children":[]},{"index":1,"text":"adaptive_kernel = tfp.mcmc.DualAveragingStepSizeAdaptation(\n    kernel, num_adaptation_steps=adapt_steps\n)","meta":{},"html":"<pre class=\"grvsc-container default-dark\" data-language=\"py\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">adaptive_kernel = tfp.mcmc.DualAveragingStepSizeAdaptation(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    kernel, </span><span class=\"mtk12\">num_adaptation_steps</span><span class=\"mtk1\">=adapt_steps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span></code></pre>","preClassName":"grvsc-container default-dark","codeClassName":"grvsc-code","language":"py","defaultTheme":{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]},"additionalThemes":[{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]}],"tokenizedLines":[{"text":"adaptive_kernel = tfp.mcmc.DualAveragingStepSizeAdaptation(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"adaptive_kernel","startIndex":0,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">adaptive_kernel</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":16,"endIndex":17,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":18,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":21,"endIndex":22,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":22,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":26,"endIndex":27,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"DualAveragingStepSizeAdaptation","startIndex":27,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">DualAveragingStepSizeAdaptation</span>"},{"text":"(","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">adaptive_kernel = tfp.mcmc.DualAveragingStepSizeAdaptation(</span></span></span>"},{"text":"    kernel, num_adaptation_steps=adapt_steps","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"kernel","startIndex":4,"endIndex":10,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel</span>"},{"text":",","startIndex":10,"endIndex":11,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"num_adaptation_steps","startIndex":12,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_adaptation_steps</span>"},{"text":"=","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"adapt_steps","startIndex":33,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">adapt_steps</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    kernel, </span><span class=\"mtk12\">num_adaptation_steps</span><span class=\"mtk1\">=adapt_steps</span></span></span>"},{"text":")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>"}],"id":"998ca6b4-f78a-5757-9cf0-47ea26619fbe","parent":"c0e1786f-a24c-5cb8-8f6d-ac33c4b0dfed","internal":{"type":"GRVSCCodeBlock","contentDigest":"d7480280d272cb172d7f5a94a708ed5e","counter":1026,"owner":"gatsby-plugin-mdx"},"children":[]},{"index":2,"text":"import functools as ft\n\nimport tensorflow as tf\nimport tensorflow_probability as tfp\n\nfrom bnn import build_net, chunks, target_log_prob_fn_factory\n\n\ndef pre_train_nn(X_train, y_train, nodes_per_layer, epochs=100):\n    \"\"\"Pre-train NN to get good starting point for HMC.\n\n    Args:\n        nodes_per_layer (list): the number of nodes in each dense layer\n        X_train (Tensor or np.array): training samples\n        y_train (Tensor or np.array): training labels\n\n    Returns:\n        Tensor: list of arrays specifying the weights of the trained network\n        model: Keras Sequential model\n    \"\"\"\n    layers = [tf.keras.layers.Dense(n, activation=\"relu\") for n in nodes_per_layer]\n    layers[-1].activation = tf.identity  # Make last layer linear.\n    model = tf.keras.Sequential(layers)\n\n    model.compile(loss=\"mse\", optimizer=\"adam\")\n    model.fit(X_train, y_train, epochs=epochs, verbose=0)\n    return model.get_weights(), model\n\n\ndef trace_fn(current_state, kernel_results, summary_freq=10, callbacks=[]):\n    \"\"\"Can be passed to the HMC kernel to obtain a trace of intermediate\n    kernel results and histograms of the network parameters in Tensorboard.\n    \"\"\"\n    step = kernel_results.step\n    with tf.summary.record_if(tf.equal(step % summary_freq, 0)):\n        for idx, tensor in enumerate(current_state):\n            count = idx // 2 + 1\n            name = (\"w\" if idx % 2 == 0 else \"b\") + str(count)\n            tf.summary.histogram(name, tensor, step=step)\n        return kernel_results, [cb(*current_state) for cb in callbacks]\n\n\n@tf.function(experimental_compile=True)\ndef sample_chain(*args, **kwargs):\n    \"\"\"Compile static graph for tfp.mcmc.sample_chain to improve performance.\n    \"\"\"\n    return tfp.mcmc.sample_chain(*args, **kwargs)\n\n\ndef run_hmc(\n    target_log_prob_fn,\n    step_size=0.01,\n    num_leapfrog_steps=10,\n    num_burnin_steps=1000,\n    num_results=1000,\n    current_state=None,\n    resume=None,\n    log_dir=\"logs/hmc/\",\n    sampler=\"nuts\",\n    step_size_adapter=\"dual_averaging\",\n    **kwargs,\n):\n    \"\"\"Use adaptive HMC to generate a Markov chain of length num_results.\n\n    Args:\n        target_log_prob_fn {callable}: Determines the stationary distribution\n        the Markov chain should converge to.\n\n    Returns:\n        burnin(s): Discarded samples generated during warm-up\n        chain(s): Markov chain(s) of samples distributed according to\n            target_log_prob_fn (if converged)\n        trace: the data collected by trace_fn\n        final_kernel_result: kernel results of the last step (in case the\n            computation needs to be resumed)\n    \"\"\"\n    err = \"Either current_state or resume is required when calling run_hmc\"\n    assert current_state is not None or resume is not None, err\n\n    summary_writer = tf.summary.create_file_writer(log_dir)\n\n    step_size_adapter = {\n        \"simple\": tfp.mcmc.SimpleStepSizeAdaptation,\n        \"dual_averaging\": tfp.mcmc.DualAveragingStepSizeAdaptation,\n    }[step_size_adapter]\n    if sampler == \"nuts\":\n        kernel = tfp.mcmc.NoUTurnSampler(target_log_prob_fn, step_size=step_size)\n        adaptive_kernel = step_size_adapter(\n            kernel,\n            num_adaptation_steps=num_burnin_steps,\n            step_size_setter_fn=lambda pkr, new_step_size: pkr._replace(\n                step_size=new_step_size\n            ),\n            step_size_getter_fn=lambda pkr: pkr.step_size,\n            log_accept_prob_getter_fn=lambda pkr: pkr.log_accept_ratio,\n        )\n    elif sampler == \"hmc\":\n        kernel = tfp.mcmc.HamiltonianMonteCarlo(\n            target_log_prob_fn,\n            step_size=step_size,\n            num_leapfrog_steps=num_leapfrog_steps,\n        )\n        adaptive_kernel = step_size_adapter(\n            kernel, num_adaptation_steps=num_burnin_steps\n        )\n\n    if resume:\n        prev_chain, prev_trace, prev_kernel_results = resume\n        step = len(prev_chain)\n        current_state = tf.nest.map_structure(lambda chain: chain[-1], prev_chain)\n    else:\n        prev_kernel_results = adaptive_kernel.bootstrap_results(current_state)\n        step = 0\n\n    tf.summary.trace_on(graph=True, profiler=False)\n\n    chain, trace, final_kernel_results = sample_chain(\n        kernel=adaptive_kernel,\n        current_state=current_state,\n        previous_kernel_results=prev_kernel_results,\n        num_results=num_burnin_steps + num_results,\n        trace_fn=ft.partial(trace_fn, summary_freq=20),\n        return_final_kernel_results=True,\n        **kwargs,\n    )\n\n    with summary_writer.as_default():\n        tf.summary.trace_export(name=\"hmc_trace\", step=step)\n    summary_writer.close()\n\n    if resume:\n        chain = nest_concat(prev_chain, chain)\n        trace = nest_concat(prev_trace, trace)\n    burnin, samples = zip(*[(t[:-num_results], t[-num_results:]) for t in chain])\n    return burnin, samples, trace, final_kernel_results\n\n\ndef predict_from_chain(chain, X_test, uncertainty=\"aleatoric+epistemic\"):\n    \"\"\"Takes a Markov chain of NN configurations and does the actual\n    prediction on a test set X_test including aleatoric and optionally\n    epistemic uncertainty estimation.\n    \"\"\"\n    err = f\"unrecognized uncertainty type: {uncertainty}\"\n    assert uncertainty in [\"aleatoric\", \"aleatoric+epistemic\"], err\n\n    if uncertainty == \"aleatoric\":\n        post_params = [tf.reduce_mean(t, axis=0) for t in chain]\n        post_model = build_net(post_params)\n        y_pred, y_var = post_model(X_test, training=False)\n\n        return y_pred.numpy(), y_var.numpy()\n\n    if uncertainty == \"aleatoric+epistemic\":\n        restructured_chain = [\n            [tensor[i] for tensor in chain] for i in range(len(chain[0]))\n        ]\n\n        def predict(params):\n            post_model = build_net(params)\n            y_pred, y_var = post_model(X_test, training=False)\n            return y_pred, y_var\n\n        preds = [predict(chunks(params, 2)) for params in restructured_chain]\n        y_pred_mc_samples, y_var_mc_samples = tf.unstack(preds, axis=1,)\n        y_pred, y_var_epist = tf.nn.moments(y_pred_mc_samples, axes=0)\n        y_var_aleat = tf.reduce_mean(y_var_mc_samples, axis=0)\n        y_var_tot = y_var_epist + y_var_aleat\n        return y_pred, y_var_tot\n\n\ndef nest_concat(*args, axis=0):\n    \"\"\"Utility function for concatenating a new Markov chain or trace with\n    older ones when resuming a previous calculation.\n    \"\"\"\n    return tf.nest.map_structure(lambda *parts: tf.concat(parts, axis=axis), *args)","meta":{},"html":"<pre class=\"grvsc-container default-dark\" data-language=\"py\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> functools </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> ft</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow_probability </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tfp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> bnn </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> build_net, chunks, target_log_prob_fn_factory</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pre_train_nn</span><span class=\"mtk1\">(</span><span class=\"mtk12\">X_train</span><span class=\"mtk1\">, </span><span class=\"mtk12\">y_train</span><span class=\"mtk1\">, </span><span class=\"mtk12\">nodes_per_layer</span><span class=\"mtk1\">, </span><span class=\"mtk12\">epochs</span><span class=\"mtk1\">=</span><span class=\"mtk7\">100</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Pre-train NN to get good starting point for HMC.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Args:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        nodes_per_layer (list): the number of nodes in each dense layer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        X_train (Tensor or np.array): training samples</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        y_train (Tensor or np.array): training labels</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Returns:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        Tensor: list of arrays specifying the weights of the trained network</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        model: Keras Sequential model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    layers = [tf.keras.layers.Dense(n, </span><span class=\"mtk12\">activation</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;relu&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> n </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> nodes_per_layer]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    layers[-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">].activation = tf.identity  </span><span class=\"mtk3\"># Make last layer linear.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    model = tf.keras.Sequential(layers)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    model.compile(</span><span class=\"mtk12\">loss</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;mse&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">optimizer</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;adam&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    model.fit(X_train, y_train, </span><span class=\"mtk12\">epochs</span><span class=\"mtk1\">=epochs, </span><span class=\"mtk12\">verbose</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> model.get_weights(), model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">trace_fn</span><span class=\"mtk1\">(</span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">, </span><span class=\"mtk12\">kernel_results</span><span class=\"mtk1\">, </span><span class=\"mtk12\">summary_freq</span><span class=\"mtk1\">=</span><span class=\"mtk7\">10</span><span class=\"mtk1\">, </span><span class=\"mtk12\">callbacks</span><span class=\"mtk1\">=[]):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Can be passed to the HMC kernel to obtain a trace of intermediate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    kernel results and histograms of the network parameters in Tensorboard.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    step = kernel_results.step</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">with</span><span class=\"mtk1\"> tf.summary.record_if(tf.equal(step % summary_freq, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">)):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> idx, tensor </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">enumerate</span><span class=\"mtk1\">(current_state):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            count = idx // </span><span class=\"mtk7\">2</span><span class=\"mtk1\"> + </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            name = (</span><span class=\"mtk8\">&quot;w&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> idx % </span><span class=\"mtk7\">2</span><span class=\"mtk1\"> == </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;b&quot;</span><span class=\"mtk1\">) + </span><span class=\"mtk10\">str</span><span class=\"mtk1\">(count)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            tf.summary.histogram(name, tensor, </span><span class=\"mtk12\">step</span><span class=\"mtk1\">=step)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> kernel_results, [cb(*current_state) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> cb </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> callbacks]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">@tf.function</span><span class=\"mtk1\">(</span><span class=\"mtk12\">experimental_compile</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">sample_chain</span><span class=\"mtk1\">(*</span><span class=\"mtk12\">args</span><span class=\"mtk1\">, **</span><span class=\"mtk12\">kwargs</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Compile static graph for tfp.mcmc.sample_chain to improve performance.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tfp.mcmc.sample_chain(*args, **kwargs)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">run_hmc</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">target_log_prob_fn</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0.01</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_leapfrog_steps</span><span class=\"mtk1\">=</span><span class=\"mtk7\">10</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_burnin_steps</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1000</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_results</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1000</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">=</span><span class=\"mtk4\">None</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">resume</span><span class=\"mtk1\">=</span><span class=\"mtk4\">None</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">log_dir</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;logs/hmc/&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">sampler</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;nuts&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">step_size_adapter</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;dual_averaging&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    **</span><span class=\"mtk12\">kwargs</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Use adaptive HMC to generate a Markov chain of length num_results.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Args:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        target_log_prob_fn {callable}: Determines the stationary distribution</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        the Markov chain should converge to.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Returns:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        burnin(s): Discarded samples generated during warm-up</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        chain(s): Markov chain(s) of samples distributed according to</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">            target_log_prob_fn (if converged)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        trace: the data collected by trace_fn</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        final_kernel_result: kernel results of the last step (in case the</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">            computation needs to be resumed)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    err = </span><span class=\"mtk8\">&quot;Either current_state or resume is required when calling run_hmc&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">assert</span><span class=\"mtk1\"> current_state </span><span class=\"mtk4\">is</span><span class=\"mtk1\"> </span><span class=\"mtk4\">not</span><span class=\"mtk1\"> </span><span class=\"mtk4\">None</span><span class=\"mtk1\"> </span><span class=\"mtk4\">or</span><span class=\"mtk1\"> resume </span><span class=\"mtk4\">is</span><span class=\"mtk1\"> </span><span class=\"mtk4\">not</span><span class=\"mtk1\"> </span><span class=\"mtk4\">None</span><span class=\"mtk1\">, err</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    summary_writer = tf.summary.create_file_writer(log_dir)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    step_size_adapter = {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&quot;simple&quot;</span><span class=\"mtk1\">: tfp.mcmc.SimpleStepSizeAdaptation,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&quot;dual_averaging&quot;</span><span class=\"mtk1\">: tfp.mcmc.DualAveragingStepSizeAdaptation,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }[step_size_adapter]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> sampler == </span><span class=\"mtk8\">&quot;nuts&quot;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        kernel = tfp.mcmc.NoUTurnSampler(target_log_prob_fn, </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=step_size)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        adaptive_kernel = step_size_adapter(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            kernel,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">num_adaptation_steps</span><span class=\"mtk1\">=num_burnin_steps,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">step_size_setter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">, </span><span class=\"mtk12\">new_step_size</span><span class=\"mtk1\">: pkr._replace(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=new_step_size</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">step_size_getter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">: pkr.step_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log_accept_prob_getter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">: pkr.log_accept_ratio,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">elif</span><span class=\"mtk1\"> sampler == </span><span class=\"mtk8\">&quot;hmc&quot;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        kernel = tfp.mcmc.HamiltonianMonteCarlo(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            target_log_prob_fn,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=step_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">num_leapfrog_steps</span><span class=\"mtk1\">=num_leapfrog_steps,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        adaptive_kernel = step_size_adapter(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            kernel, </span><span class=\"mtk12\">num_adaptation_steps</span><span class=\"mtk1\">=num_burnin_steps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> resume:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        prev_chain, prev_trace, prev_kernel_results = resume</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        step = </span><span class=\"mtk11\">len</span><span class=\"mtk1\">(prev_chain)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        current_state = tf.nest.map_structure(</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">chain</span><span class=\"mtk1\">: chain[-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">], prev_chain)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        prev_kernel_results = adaptive_kernel.bootstrap_results(current_state)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        step = </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tf.summary.trace_on(</span><span class=\"mtk12\">graph</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">, </span><span class=\"mtk12\">profiler</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    chain, trace, final_kernel_results = sample_chain(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">kernel</span><span class=\"mtk1\">=adaptive_kernel,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">=current_state,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">previous_kernel_results</span><span class=\"mtk1\">=prev_kernel_results,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">num_results</span><span class=\"mtk1\">=num_burnin_steps + num_results,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">trace_fn</span><span class=\"mtk1\">=ft.partial(trace_fn, </span><span class=\"mtk12\">summary_freq</span><span class=\"mtk1\">=</span><span class=\"mtk7\">20</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">return_final_kernel_results</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        **kwargs,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">with</span><span class=\"mtk1\"> summary_writer.as_default():</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        tf.summary.trace_export(</span><span class=\"mtk12\">name</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;hmc_trace&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">step</span><span class=\"mtk1\">=step)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    summary_writer.close()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> resume:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        chain = nest_concat(prev_chain, chain)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        trace = nest_concat(prev_trace, trace)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    burnin, samples = </span><span class=\"mtk11\">zip</span><span class=\"mtk1\">(*[(t[:-num_results], t[-num_results:]) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> t </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> chain])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> burnin, samples, trace, final_kernel_results</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">predict_from_chain</span><span class=\"mtk1\">(</span><span class=\"mtk12\">chain</span><span class=\"mtk1\">, </span><span class=\"mtk12\">X_test</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uncertainty</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;aleatoric+epistemic&quot;</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Takes a Markov chain of NN configurations and does the actual</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    prediction on a test set X_test including aleatoric and optionally</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    epistemic uncertainty estimation.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    err = </span><span class=\"mtk4\">f</span><span class=\"mtk8\">&quot;unrecognized uncertainty type: </span><span class=\"mtk4\">{</span><span class=\"mtk1\">uncertainty</span><span class=\"mtk4\">}</span><span class=\"mtk8\">&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">assert</span><span class=\"mtk1\"> uncertainty </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&quot;aleatoric&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;aleatoric+epistemic&quot;</span><span class=\"mtk1\">], err</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> uncertainty == </span><span class=\"mtk8\">&quot;aleatoric&quot;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        post_params = [tf.reduce_mean(t, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> t </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> chain]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        post_model = build_net(post_params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_pred, y_var = post_model(X_test, </span><span class=\"mtk12\">training</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> y_pred.numpy(), y_var.numpy()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> uncertainty == </span><span class=\"mtk8\">&quot;aleatoric+epistemic&quot;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        restructured_chain = [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            [tensor[i] </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> tensor </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> chain] </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> i </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">range</span><span class=\"mtk1\">(</span><span class=\"mtk11\">len</span><span class=\"mtk1\">(chain[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">]))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">predict</span><span class=\"mtk1\">(</span><span class=\"mtk12\">params</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            post_model = build_net(params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            y_pred, y_var = post_model(X_test, </span><span class=\"mtk12\">training</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> y_pred, y_var</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        preds = [predict(chunks(params, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">)) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> params </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> restructured_chain]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_pred_mc_samples, y_var_mc_samples = tf.unstack(preds, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1</span><span class=\"mtk1\">,)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_pred, y_var_epist = tf.nn.moments(y_pred_mc_samples, </span><span class=\"mtk12\">axes</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_var_aleat = tf.reduce_mean(y_var_mc_samples, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_var_tot = y_var_epist + y_var_aleat</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> y_pred, y_var_tot</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">nest_concat</span><span class=\"mtk1\">(*</span><span class=\"mtk12\">args</span><span class=\"mtk1\">, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Utility function for concatenating a new Markov chain or trace with</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    older ones when resuming a previous calculation.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tf.nest.map_structure(</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> *</span><span class=\"mtk12\">parts</span><span class=\"mtk1\">: tf.concat(parts, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=axis), *args)</span></span></span></code></pre>","preClassName":"grvsc-container default-dark","codeClassName":"grvsc-code","language":"py","defaultTheme":{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]},"additionalThemes":[{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]}],"tokenizedLines":[{"text":"import functools as ft","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"functools","startIndex":7,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">functools</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":17,"endIndex":19,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"ft","startIndex":20,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">ft</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> functools </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> ft</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"import tensorflow as tf","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow","startIndex":7,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":18,"endIndex":20,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":21,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>"},{"text":"import tensorflow_probability as tfp","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow_probability","startIndex":7,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow_probability</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":30,"endIndex":32,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":32,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":33,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow_probability </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tfp</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"from bnn import build_net, chunks, target_log_prob_fn_factory","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"from","startIndex":0,"endIndex":4,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">from</span>"},{"text":" ","startIndex":4,"endIndex":5,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bnn","startIndex":5,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"import","startIndex":9,"endIndex":15,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"build_net","startIndex":16,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">build_net</span>"},{"text":",","startIndex":25,"endIndex":26,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chunks","startIndex":27,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chunks</span>"},{"text":",","startIndex":33,"endIndex":34,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":34,"endIndex":35,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"target_log_prob_fn_factory","startIndex":35,"endIndex":61,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">target_log_prob_fn_factory</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> bnn </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> build_net, chunks, target_log_prob_fn_factory</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def pre_train_nn(X_train, y_train, nodes_per_layer, epochs=100):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pre_train_nn","startIndex":4,"endIndex":16,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">pre_train_nn</span>"},{"text":"(","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X_train","startIndex":17,"endIndex":24,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">X_train</span>"},{"text":",","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_train","startIndex":26,"endIndex":33,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">y_train</span>"},{"text":",","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"nodes_per_layer","startIndex":35,"endIndex":50,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">nodes_per_layer</span>"},{"text":",","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"epochs","startIndex":52,"endIndex":58,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">epochs</span>"},{"text":"=","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"100","startIndex":59,"endIndex":62,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">100</span>"},{"text":")","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">pre_train_nn</span><span class=\"mtk1\">(</span><span class=\"mtk12\">X_train</span><span class=\"mtk1\">, </span><span class=\"mtk12\">y_train</span><span class=\"mtk1\">, </span><span class=\"mtk12\">nodes_per_layer</span><span class=\"mtk1\">, </span><span class=\"mtk12\">epochs</span><span class=\"mtk1\">=</span><span class=\"mtk7\">100</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    \"\"\"Pre-train NN to get good starting point for HMC.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"Pre-train NN to get good starting point for HMC.","startIndex":7,"endIndex":56,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Pre-train NN to get good starting point for HMC.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Pre-train NN to get good starting point for HMC.</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    Args:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    Args:","startIndex":0,"endIndex":10,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    Args:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Args:</span></span></span>"},{"text":"        nodes_per_layer (list): the number of nodes in each dense layer","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        nodes_per_layer (list): the number of nodes in each dense layer","startIndex":0,"endIndex":72,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        nodes_per_layer (list): the number of nodes in each dense layer</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        nodes_per_layer (list): the number of nodes in each dense layer</span></span></span>"},{"text":"        X_train (Tensor or np.array): training samples","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        X_train (Tensor or np.array): training samples","startIndex":0,"endIndex":55,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        X_train (Tensor or np.array): training samples</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        X_train (Tensor or np.array): training samples</span></span></span>"},{"text":"        y_train (Tensor or np.array): training labels","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        y_train (Tensor or np.array): training labels","startIndex":0,"endIndex":54,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        y_train (Tensor or np.array): training labels</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        y_train (Tensor or np.array): training labels</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    Returns:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    Returns:","startIndex":0,"endIndex":13,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    Returns:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Returns:</span></span></span>"},{"text":"        Tensor: list of arrays specifying the weights of the trained network","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        Tensor: list of arrays specifying the weights of the trained network","startIndex":0,"endIndex":77,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        Tensor: list of arrays specifying the weights of the trained network</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        Tensor: list of arrays specifying the weights of the trained network</span></span></span>"},{"text":"        model: Keras Sequential model","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        model: Keras Sequential model","startIndex":0,"endIndex":38,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        model: Keras Sequential model</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        model: Keras Sequential model</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    layers = [tf.keras.layers.Dense(n, activation=\"relu\") for n in nodes_per_layer]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"layers","startIndex":4,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">layers</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":11,"endIndex":12,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"tf","startIndex":14,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"keras","startIndex":17,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">keras</span>"},{"text":".","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"layers","startIndex":23,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">layers</span>"},{"text":".","startIndex":29,"endIndex":30,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Dense","startIndex":30,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Dense</span>"},{"text":"(","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"n","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n</span>"},{"text":",","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"activation","startIndex":39,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">activation</span>"},{"text":"=","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"\"","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"relu","startIndex":51,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">relu</span>"},{"text":"\"","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":")","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":57,"endIndex":58,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":58,"endIndex":61,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":61,"endIndex":62,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n","startIndex":62,"endIndex":63,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n</span>"},{"text":" ","startIndex":63,"endIndex":64,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":64,"endIndex":66,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":66,"endIndex":67,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"nodes_per_layer","startIndex":67,"endIndex":82,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nodes_per_layer</span>"},{"text":"]","startIndex":82,"endIndex":83,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    layers = [tf.keras.layers.Dense(n, </span><span class=\"mtk12\">activation</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;relu&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> n </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> nodes_per_layer]</span></span></span>"},{"text":"    layers[-1].activation = tf.identity  # Make last layer linear.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"layers","startIndex":4,"endIndex":10,"scopes":["source.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">layers</span>"},{"text":"[","startIndex":10,"endIndex":11,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"-","startIndex":11,"endIndex":12,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":12,"endIndex":13,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":"]","startIndex":13,"endIndex":14,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":".","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"activation","startIndex":15,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">activation</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":26,"endIndex":27,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":28,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"identity","startIndex":31,"endIndex":39,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">identity</span>"},{"text":"  ","startIndex":39,"endIndex":41,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">  </span>"},{"text":"#","startIndex":41,"endIndex":42,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" Make last layer linear.","startIndex":42,"endIndex":66,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> Make last layer linear.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    layers[-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">].activation = tf.identity  </span><span class=\"mtk3\"># Make last layer linear.</span></span></span>"},{"text":"    model = tf.keras.Sequential(layers)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"model","startIndex":4,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">model</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":10,"endIndex":11,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":12,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"keras","startIndex":15,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">keras</span>"},{"text":".","startIndex":20,"endIndex":21,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Sequential","startIndex":21,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Sequential</span>"},{"text":"(","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"layers","startIndex":32,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">layers</span>"},{"text":")","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    model = tf.keras.Sequential(layers)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    model.compile(loss=\"mse\", optimizer=\"adam\")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"model","startIndex":4,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">model</span>"},{"text":".","startIndex":9,"endIndex":10,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"compile","startIndex":10,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">compile</span>"},{"text":"(","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"loss","startIndex":18,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">loss</span>"},{"text":"=","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"\"","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"mse","startIndex":24,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">mse</span>"},{"text":"\"","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":",","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"optimizer","startIndex":30,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">optimizer</span>"},{"text":"=","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"\"","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"adam","startIndex":41,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">adam</span>"},{"text":"\"","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":")","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    model.compile(</span><span class=\"mtk12\">loss</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;mse&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">optimizer</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;adam&quot;</span><span class=\"mtk1\">)</span></span></span>"},{"text":"    model.fit(X_train, y_train, epochs=epochs, verbose=0)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"model","startIndex":4,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">model</span>"},{"text":".","startIndex":9,"endIndex":10,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"fit","startIndex":10,"endIndex":13,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">fit</span>"},{"text":"(","startIndex":13,"endIndex":14,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X_train","startIndex":14,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_train</span>"},{"text":",","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_train","startIndex":23,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_train</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"epochs","startIndex":32,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">epochs</span>"},{"text":"=","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"epochs","startIndex":39,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">epochs</span>"},{"text":",","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"verbose","startIndex":47,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">verbose</span>"},{"text":"=","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"0","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":")","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    model.fit(X_train, y_train, </span><span class=\"mtk12\">epochs</span><span class=\"mtk1\">=epochs, </span><span class=\"mtk12\">verbose</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)</span></span></span>"},{"text":"    return model.get_weights(), model","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"model","startIndex":11,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">model</span>"},{"text":".","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"get_weights","startIndex":17,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_weights</span>"},{"text":"(","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":31,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"model","startIndex":32,"endIndex":37,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">model</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> model.get_weights(), model</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def trace_fn(current_state, kernel_results, summary_freq=10, callbacks=[]):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"trace_fn","startIndex":4,"endIndex":12,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">trace_fn</span>"},{"text":"(","startIndex":12,"endIndex":13,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"current_state","startIndex":13,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">current_state</span>"},{"text":",","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"kernel_results","startIndex":28,"endIndex":42,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">kernel_results</span>"},{"text":",","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"summary_freq","startIndex":44,"endIndex":56,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">summary_freq</span>"},{"text":"=","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"10","startIndex":57,"endIndex":59,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">10</span>"},{"text":",","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":60,"endIndex":61,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"callbacks","startIndex":61,"endIndex":70,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">callbacks</span>"},{"text":"=","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"[","startIndex":71,"endIndex":72,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"]","startIndex":72,"endIndex":73,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":73,"endIndex":74,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":74,"endIndex":75,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">trace_fn</span><span class=\"mtk1\">(</span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">, </span><span class=\"mtk12\">kernel_results</span><span class=\"mtk1\">, </span><span class=\"mtk12\">summary_freq</span><span class=\"mtk1\">=</span><span class=\"mtk7\">10</span><span class=\"mtk1\">, </span><span class=\"mtk12\">callbacks</span><span class=\"mtk1\">=[]):</span></span></span>"},{"text":"    \"\"\"Can be passed to the HMC kernel to obtain a trace of intermediate","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"Can be passed to the HMC kernel to obtain a trace of intermediate","startIndex":7,"endIndex":73,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Can be passed to the HMC kernel to obtain a trace of intermediate</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Can be passed to the HMC kernel to obtain a trace of intermediate</span></span></span>"},{"text":"    kernel results and histograms of the network parameters in Tensorboard.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    kernel results and histograms of the network parameters in Tensorboard.","startIndex":0,"endIndex":76,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    kernel results and histograms of the network parameters in Tensorboard.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    kernel results and histograms of the network parameters in Tensorboard.</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    step = kernel_results.step","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"step","startIndex":4,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":9,"endIndex":10,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"kernel_results","startIndex":11,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel_results</span>"},{"text":".","startIndex":25,"endIndex":26,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"step","startIndex":26,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    step = kernel_results.step</span></span></span>"},{"text":"    with tf.summary.record_if(tf.equal(step % summary_freq, 0)):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"with","startIndex":4,"endIndex":8,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">with</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":9,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":11,"endIndex":12,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"summary","startIndex":12,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary</span>"},{"text":".","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"record_if","startIndex":20,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">record_if</span>"},{"text":"(","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"tf","startIndex":30,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"equal","startIndex":33,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">equal</span>"},{"text":"(","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"step","startIndex":39,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"%","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">%</span>"},{"text":" ","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"summary_freq","startIndex":46,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary_freq</span>"},{"text":",","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0","startIndex":60,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":")","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":63,"endIndex":64,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">with</span><span class=\"mtk1\"> tf.summary.record_if(tf.equal(step % summary_freq, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">)):</span></span></span>"},{"text":"        for idx, tensor in enumerate(current_state):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"for","startIndex":8,"endIndex":11,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"idx","startIndex":12,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">idx</span>"},{"text":",","startIndex":15,"endIndex":16,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensor","startIndex":17,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensor</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":24,"endIndex":26,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"enumerate","startIndex":27,"endIndex":36,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">enumerate</span>"},{"text":"(","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"current_state","startIndex":37,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">current_state</span>"},{"text":")","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":51,"endIndex":52,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> idx, tensor </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">enumerate</span><span class=\"mtk1\">(current_state):</span></span></span>"},{"text":"            count = idx // 2 + 1","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"count","startIndex":12,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">count</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":18,"endIndex":19,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"idx","startIndex":20,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">idx</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"//","startIndex":24,"endIndex":26,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">//</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"2","startIndex":27,"endIndex":28,"scopes":["source.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":" ","startIndex":28,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+","startIndex":29,"endIndex":30,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"1","startIndex":31,"endIndex":32,"scopes":["source.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            count = idx // </span><span class=\"mtk7\">2</span><span class=\"mtk1\"> + </span><span class=\"mtk7\">1</span></span></span>"},{"text":"            name = (\"w\" if idx % 2 == 0 else \"b\") + str(count)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"name","startIndex":12,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">name</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":17,"endIndex":18,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"(","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.parenthesis.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"\"","startIndex":20,"endIndex":21,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"w","startIndex":21,"endIndex":22,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">w</span>"},{"text":"\"","startIndex":22,"endIndex":23,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"if","startIndex":24,"endIndex":26,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"idx","startIndex":27,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">idx</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"%","startIndex":31,"endIndex":32,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">%</span>"},{"text":" ","startIndex":32,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"2","startIndex":33,"endIndex":34,"scopes":["source.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":" ","startIndex":34,"endIndex":35,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"==","startIndex":35,"endIndex":37,"scopes":["source.python","keyword.operator.comparison.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">==</span>"},{"text":" ","startIndex":37,"endIndex":38,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0","startIndex":38,"endIndex":39,"scopes":["source.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"else","startIndex":40,"endIndex":44,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">else</span>"},{"text":" ","startIndex":44,"endIndex":45,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"\"","startIndex":45,"endIndex":46,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"b","startIndex":46,"endIndex":47,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">b</span>"},{"text":"\"","startIndex":47,"endIndex":48,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":")","startIndex":48,"endIndex":49,"scopes":["source.python","punctuation.parenthesis.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":49,"endIndex":50,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+","startIndex":50,"endIndex":51,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+</span>"},{"text":" ","startIndex":51,"endIndex":52,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"str","startIndex":52,"endIndex":55,"scopes":["source.python","meta.function-call.python","support.type.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk10","bold":false,"italic":false,"underline":false,"meta":16941098,"color":"#4EC9B0"},"additionalThemeTokenData":[],"className":"mtk10","html":"<span class=\"mtk10\">str</span>"},{"text":"(","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"count","startIndex":56,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">count</span>"},{"text":")","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            name = (</span><span class=\"mtk8\">&quot;w&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> idx % </span><span class=\"mtk7\">2</span><span class=\"mtk1\"> == </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;b&quot;</span><span class=\"mtk1\">) + </span><span class=\"mtk10\">str</span><span class=\"mtk1\">(count)</span></span></span>"},{"text":"            tf.summary.histogram(name, tensor, step=step)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"tf","startIndex":12,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"summary","startIndex":15,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary</span>"},{"text":".","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"histogram","startIndex":23,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">histogram</span>"},{"text":"(","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"name","startIndex":33,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">name</span>"},{"text":",","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensor","startIndex":39,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensor</span>"},{"text":",","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"step","startIndex":47,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step</span>"},{"text":"=","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"step","startIndex":52,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step</span>"},{"text":")","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            tf.summary.histogram(name, tensor, </span><span class=\"mtk12\">step</span><span class=\"mtk1\">=step)</span></span></span>"},{"text":"        return kernel_results, [cb(*current_state) for cb in callbacks]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"return","startIndex":8,"endIndex":14,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"kernel_results","startIndex":15,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel_results</span>"},{"text":",","startIndex":29,"endIndex":30,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":31,"endIndex":32,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"cb","startIndex":32,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">cb</span>"},{"text":"(","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"current_state","startIndex":36,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">current_state</span>"},{"text":")","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":50,"endIndex":51,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":51,"endIndex":54,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"cb","startIndex":55,"endIndex":57,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">cb</span>"},{"text":" ","startIndex":57,"endIndex":58,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":58,"endIndex":60,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":60,"endIndex":61,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"callbacks","startIndex":61,"endIndex":70,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">callbacks</span>"},{"text":"]","startIndex":70,"endIndex":71,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> kernel_results, [cb(*current_state) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> cb </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> callbacks]</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"@tf.function(experimental_compile=True)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"@","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python","punctuation.definition.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">@</span>"},{"text":"tf","startIndex":1,"endIndex":3,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">tf</span>"},{"text":".","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">.</span>"},{"text":"function","startIndex":4,"endIndex":12,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">function</span>"},{"text":"(","startIndex":12,"endIndex":13,"scopes":["source.python","meta.function.decorator.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"experimental_compile","startIndex":13,"endIndex":33,"scopes":["source.python","meta.function.decorator.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">experimental_compile</span>"},{"text":"=","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function.decorator.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"True","startIndex":34,"endIndex":38,"scopes":["source.python","meta.function.decorator.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">True</span>"},{"text":")","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function.decorator.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">@tf.function</span><span class=\"mtk1\">(</span><span class=\"mtk12\">experimental_compile</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">)</span></span></span>"},{"text":"def sample_chain(*args, **kwargs):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"sample_chain","startIndex":4,"endIndex":16,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">sample_chain</span>"},{"text":"(","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.unpacking.parameter.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"args","startIndex":18,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">args</span>"},{"text":",","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"**","startIndex":24,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.unpacking.parameter.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">**</span>"},{"text":"kwargs","startIndex":26,"endIndex":32,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">kwargs</span>"},{"text":")","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">sample_chain</span><span class=\"mtk1\">(*</span><span class=\"mtk12\">args</span><span class=\"mtk1\">, **</span><span class=\"mtk12\">kwargs</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    \"\"\"Compile static graph for tfp.mcmc.sample_chain to improve performance.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"Compile static graph for tfp.mcmc.sample_chain to improve performance.","startIndex":7,"endIndex":78,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Compile static graph for tfp.mcmc.sample_chain to improve performance.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Compile static graph for tfp.mcmc.sample_chain to improve performance.</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    return tfp.mcmc.sample_chain(*args, **kwargs)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":11,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":15,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"sample_chain","startIndex":20,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sample_chain</span>"},{"text":"(","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"args","startIndex":34,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">args</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"**","startIndex":40,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">**</span>"},{"text":"kwargs","startIndex":42,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kwargs</span>"},{"text":")","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tfp.mcmc.sample_chain(*args, **kwargs)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def run_hmc(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"run_hmc","startIndex":4,"endIndex":11,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">run_hmc</span>"},{"text":"(","startIndex":11,"endIndex":12,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">run_hmc</span><span class=\"mtk1\">(</span></span></span>"},{"text":"    target_log_prob_fn,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"target_log_prob_fn","startIndex":4,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">target_log_prob_fn</span>"},{"text":",","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">target_log_prob_fn</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    step_size=0.01,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"step_size","startIndex":4,"endIndex":13,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size</span>"},{"text":"=","startIndex":13,"endIndex":14,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"0.01","startIndex":14,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.01</span>"},{"text":",","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0.01</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    num_leapfrog_steps=10,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"num_leapfrog_steps","startIndex":4,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_leapfrog_steps</span>"},{"text":"=","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"10","startIndex":23,"endIndex":25,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">10</span>"},{"text":",","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_leapfrog_steps</span><span class=\"mtk1\">=</span><span class=\"mtk7\">10</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    num_burnin_steps=1000,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"num_burnin_steps","startIndex":4,"endIndex":20,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_burnin_steps</span>"},{"text":"=","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"1000","startIndex":21,"endIndex":25,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1000</span>"},{"text":",","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_burnin_steps</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1000</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    num_results=1000,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"num_results","startIndex":4,"endIndex":15,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_results</span>"},{"text":"=","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"1000","startIndex":16,"endIndex":20,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1000</span>"},{"text":",","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">num_results</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1000</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    current_state=None,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"current_state","startIndex":4,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">current_state</span>"},{"text":"=","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"None","startIndex":18,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">None</span>"},{"text":",","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">=</span><span class=\"mtk4\">None</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    resume=None,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"resume","startIndex":4,"endIndex":10,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">resume</span>"},{"text":"=","startIndex":10,"endIndex":11,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"None","startIndex":11,"endIndex":15,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">None</span>"},{"text":",","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">resume</span><span class=\"mtk1\">=</span><span class=\"mtk4\">None</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    log_dir=\"logs/hmc/\",","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"log_dir","startIndex":4,"endIndex":11,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">log_dir</span>"},{"text":"=","startIndex":11,"endIndex":12,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"\"","startIndex":12,"endIndex":13,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"logs/hmc/","startIndex":13,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">logs/hmc/</span>"},{"text":"\"","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":",","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">log_dir</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;logs/hmc/&quot;</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    sampler=\"nuts\",","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"sampler","startIndex":4,"endIndex":11,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">sampler</span>"},{"text":"=","startIndex":11,"endIndex":12,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"\"","startIndex":12,"endIndex":13,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"nuts","startIndex":13,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">nuts</span>"},{"text":"\"","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":",","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">sampler</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;nuts&quot;</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    step_size_adapter=\"dual_averaging\",","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"step_size_adapter","startIndex":4,"endIndex":21,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size_adapter</span>"},{"text":"=","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"\"","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"dual_averaging","startIndex":23,"endIndex":37,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">dual_averaging</span>"},{"text":"\"","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">step_size_adapter</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;dual_averaging&quot;</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    **kwargs,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"**","startIndex":4,"endIndex":6,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.unpacking.parameter.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">**</span>"},{"text":"kwargs","startIndex":6,"endIndex":12,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">kwargs</span>"},{"text":",","startIndex":12,"endIndex":13,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    **</span><span class=\"mtk12\">kwargs</span><span class=\"mtk1\">,</span></span></span>"},{"text":"):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":1,"endIndex":2,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">):</span></span></span>"},{"text":"    \"\"\"Use adaptive HMC to generate a Markov chain of length num_results.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"Use adaptive HMC to generate a Markov chain of length num_results.","startIndex":7,"endIndex":74,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Use adaptive HMC to generate a Markov chain of length num_results.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Use adaptive HMC to generate a Markov chain of length num_results.</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    Args:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    Args:","startIndex":0,"endIndex":10,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    Args:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Args:</span></span></span>"},{"text":"        target_log_prob_fn {callable}: Determines the stationary distribution","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        target_log_prob_fn {callable}: Determines the stationary distribution","startIndex":0,"endIndex":78,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        target_log_prob_fn {callable}: Determines the stationary distribution</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        target_log_prob_fn {callable}: Determines the stationary distribution</span></span></span>"},{"text":"        the Markov chain should converge to.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        the Markov chain should converge to.","startIndex":0,"endIndex":45,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        the Markov chain should converge to.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        the Markov chain should converge to.</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    Returns:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    Returns:","startIndex":0,"endIndex":13,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    Returns:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Returns:</span></span></span>"},{"text":"        burnin(s): Discarded samples generated during warm-up","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        burnin(s): Discarded samples generated during warm-up","startIndex":0,"endIndex":62,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        burnin(s): Discarded samples generated during warm-up</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        burnin(s): Discarded samples generated during warm-up</span></span></span>"},{"text":"        chain(s): Markov chain(s) of samples distributed according to","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        chain(s): Markov chain(s) of samples distributed according to","startIndex":0,"endIndex":70,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        chain(s): Markov chain(s) of samples distributed according to</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        chain(s): Markov chain(s) of samples distributed according to</span></span></span>"},{"text":"            target_log_prob_fn (if converged)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            target_log_prob_fn (if converged)","startIndex":0,"endIndex":46,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">            target_log_prob_fn (if converged)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">            target_log_prob_fn (if converged)</span></span></span>"},{"text":"        trace: the data collected by trace_fn","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        trace: the data collected by trace_fn","startIndex":0,"endIndex":46,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        trace: the data collected by trace_fn</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        trace: the data collected by trace_fn</span></span></span>"},{"text":"        final_kernel_result: kernel results of the last step (in case the","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        final_kernel_result: kernel results of the last step (in case the","startIndex":0,"endIndex":74,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        final_kernel_result: kernel results of the last step (in case the</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        final_kernel_result: kernel results of the last step (in case the</span></span></span>"},{"text":"            computation needs to be resumed)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            computation needs to be resumed)","startIndex":0,"endIndex":45,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">            computation needs to be resumed)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">            computation needs to be resumed)</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    err = \"Either current_state or resume is required when calling run_hmc\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"err","startIndex":4,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">err</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":8,"endIndex":9,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"\"","startIndex":10,"endIndex":11,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"Either current_state or resume is required when calling run_hmc","startIndex":11,"endIndex":74,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Either current_state or resume is required when calling run_hmc</span>"},{"text":"\"","startIndex":74,"endIndex":75,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    err = </span><span class=\"mtk8\">&quot;Either current_state or resume is required when calling run_hmc&quot;</span></span></span>"},{"text":"    assert current_state is not None or resume is not None, err","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"assert","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">assert</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"current_state","startIndex":11,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">current_state</span>"},{"text":" ","startIndex":24,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"is","startIndex":25,"endIndex":27,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">is</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"not","startIndex":28,"endIndex":31,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">not</span>"},{"text":" ","startIndex":31,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"None","startIndex":32,"endIndex":36,"scopes":["source.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">None</span>"},{"text":" ","startIndex":36,"endIndex":37,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"or","startIndex":37,"endIndex":39,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">or</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"resume","startIndex":40,"endIndex":46,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">resume</span>"},{"text":" ","startIndex":46,"endIndex":47,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"is","startIndex":47,"endIndex":49,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">is</span>"},{"text":" ","startIndex":49,"endIndex":50,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"not","startIndex":50,"endIndex":53,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">not</span>"},{"text":" ","startIndex":53,"endIndex":54,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"None","startIndex":54,"endIndex":58,"scopes":["source.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">None</span>"},{"text":",","startIndex":58,"endIndex":59,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":59,"endIndex":60,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"err","startIndex":60,"endIndex":63,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">err</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">assert</span><span class=\"mtk1\"> current_state </span><span class=\"mtk4\">is</span><span class=\"mtk1\"> </span><span class=\"mtk4\">not</span><span class=\"mtk1\"> </span><span class=\"mtk4\">None</span><span class=\"mtk1\"> </span><span class=\"mtk4\">or</span><span class=\"mtk1\"> resume </span><span class=\"mtk4\">is</span><span class=\"mtk1\"> </span><span class=\"mtk4\">not</span><span class=\"mtk1\"> </span><span class=\"mtk4\">None</span><span class=\"mtk1\">, err</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    summary_writer = tf.summary.create_file_writer(log_dir)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"summary_writer","startIndex":4,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary_writer</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":19,"endIndex":20,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":21,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":23,"endIndex":24,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"summary","startIndex":24,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary</span>"},{"text":".","startIndex":31,"endIndex":32,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"create_file_writer","startIndex":32,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">create_file_writer</span>"},{"text":"(","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"log_dir","startIndex":51,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_dir</span>"},{"text":")","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    summary_writer = tf.summary.create_file_writer(log_dir)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    step_size_adapter = {","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"step_size_adapter","startIndex":4,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size_adapter</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":22,"endIndex":23,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"{","startIndex":24,"endIndex":25,"scopes":["source.python","punctuation.definition.dict.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">{</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    step_size_adapter = {</span></span></span>"},{"text":"        \"simple\": tfp.mcmc.SimpleStepSizeAdaptation,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"\"","startIndex":8,"endIndex":9,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"simple","startIndex":9,"endIndex":15,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">simple</span>"},{"text":"\"","startIndex":15,"endIndex":16,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":":","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.separator.dict.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":18,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":21,"endIndex":22,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":22,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":26,"endIndex":27,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"SimpleStepSizeAdaptation","startIndex":27,"endIndex":51,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">SimpleStepSizeAdaptation</span>"},{"text":",","startIndex":51,"endIndex":52,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&quot;simple&quot;</span><span class=\"mtk1\">: tfp.mcmc.SimpleStepSizeAdaptation,</span></span></span>"},{"text":"        \"dual_averaging\": tfp.mcmc.DualAveragingStepSizeAdaptation,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"\"","startIndex":8,"endIndex":9,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"dual_averaging","startIndex":9,"endIndex":23,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">dual_averaging</span>"},{"text":"\"","startIndex":23,"endIndex":24,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":":","startIndex":24,"endIndex":25,"scopes":["source.python","punctuation.separator.dict.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":26,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":29,"endIndex":30,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":30,"endIndex":34,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":34,"endIndex":35,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"DualAveragingStepSizeAdaptation","startIndex":35,"endIndex":66,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">DualAveragingStepSizeAdaptation</span>"},{"text":",","startIndex":66,"endIndex":67,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&quot;dual_averaging&quot;</span><span class=\"mtk1\">: tfp.mcmc.DualAveragingStepSizeAdaptation,</span></span></span>"},{"text":"    }[step_size_adapter]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"}","startIndex":4,"endIndex":5,"scopes":["source.python","punctuation.definition.dict.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">}</span>"},{"text":"[","startIndex":5,"endIndex":6,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"step_size_adapter","startIndex":6,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size_adapter</span>"},{"text":"]","startIndex":23,"endIndex":24,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }[step_size_adapter]</span></span></span>"},{"text":"    if sampler == \"nuts\":","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"if","startIndex":4,"endIndex":6,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"sampler","startIndex":7,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sampler</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"==","startIndex":15,"endIndex":17,"scopes":["source.python","keyword.operator.comparison.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">==</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"\"","startIndex":18,"endIndex":19,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"nuts","startIndex":19,"endIndex":23,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">nuts</span>"},{"text":"\"","startIndex":23,"endIndex":24,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":":","startIndex":24,"endIndex":25,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> sampler == </span><span class=\"mtk8\">&quot;nuts&quot;</span><span class=\"mtk1\">:</span></span></span>"},{"text":"        kernel = tfp.mcmc.NoUTurnSampler(target_log_prob_fn, step_size=step_size)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"kernel","startIndex":8,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":15,"endIndex":16,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":17,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":20,"endIndex":21,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":21,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":25,"endIndex":26,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"NoUTurnSampler","startIndex":26,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">NoUTurnSampler</span>"},{"text":"(","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"target_log_prob_fn","startIndex":41,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">target_log_prob_fn</span>"},{"text":",","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":60,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"step_size","startIndex":61,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size</span>"},{"text":"=","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"step_size","startIndex":71,"endIndex":80,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size</span>"},{"text":")","startIndex":80,"endIndex":81,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        kernel = tfp.mcmc.NoUTurnSampler(target_log_prob_fn, </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=step_size)</span></span></span>"},{"text":"        adaptive_kernel = step_size_adapter(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"adaptive_kernel","startIndex":8,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">adaptive_kernel</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":24,"endIndex":25,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"step_size_adapter","startIndex":26,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size_adapter</span>"},{"text":"(","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        adaptive_kernel = step_size_adapter(</span></span></span>"},{"text":"            kernel,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"kernel","startIndex":12,"endIndex":18,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel</span>"},{"text":",","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            kernel,</span></span></span>"},{"text":"            num_adaptation_steps=num_burnin_steps,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"num_adaptation_steps","startIndex":12,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_adaptation_steps</span>"},{"text":"=","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"num_burnin_steps","startIndex":33,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">num_burnin_steps</span>"},{"text":",","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">num_adaptation_steps</span><span class=\"mtk1\">=num_burnin_steps,</span></span></span>"},{"text":"            step_size_setter_fn=lambda pkr, new_step_size: pkr._replace(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"step_size_setter_fn","startIndex":12,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size_setter_fn</span>"},{"text":"=","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"lambda","startIndex":32,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":39,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">pkr</span>"},{"text":",","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"new_step_size","startIndex":44,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">new_step_size</span>"},{"text":":","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":59,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">pkr</span>"},{"text":".","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"_replace","startIndex":63,"endIndex":71,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">_replace</span>"},{"text":"(","startIndex":71,"endIndex":72,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">step_size_setter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">, </span><span class=\"mtk12\">new_step_size</span><span class=\"mtk1\">: pkr._replace(</span></span></span>"},{"text":"                step_size=new_step_size","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"                ","startIndex":0,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">                </span>"},{"text":"step_size","startIndex":16,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size</span>"},{"text":"=","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"new_step_size","startIndex":26,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">new_step_size</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=new_step_size</span></span></span>"},{"text":"            ),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":")","startIndex":12,"endIndex":13,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":13,"endIndex":14,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),</span></span></span>"},{"text":"            step_size_getter_fn=lambda pkr: pkr.step_size,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"step_size_getter_fn","startIndex":12,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size_getter_fn</span>"},{"text":"=","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"lambda","startIndex":32,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":39,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">pkr</span>"},{"text":":","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":44,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">pkr</span>"},{"text":".","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"step_size","startIndex":48,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size</span>"},{"text":",","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">step_size_getter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">: pkr.step_size,</span></span></span>"},{"text":"            log_accept_prob_getter_fn=lambda pkr: pkr.log_accept_ratio,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"log_accept_prob_getter_fn","startIndex":12,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">log_accept_prob_getter_fn</span>"},{"text":"=","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"lambda","startIndex":38,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":45,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">pkr</span>"},{"text":":","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"pkr","startIndex":50,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">pkr</span>"},{"text":".","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"log_accept_ratio","startIndex":54,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_accept_ratio</span>"},{"text":",","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log_accept_prob_getter_fn</span><span class=\"mtk1\">=</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">pkr</span><span class=\"mtk1\">: pkr.log_accept_ratio,</span></span></span>"},{"text":"        )","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":")","startIndex":8,"endIndex":9,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>"},{"text":"    elif sampler == \"hmc\":","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"elif","startIndex":4,"endIndex":8,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">elif</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"sampler","startIndex":9,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sampler</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"==","startIndex":17,"endIndex":19,"scopes":["source.python","keyword.operator.comparison.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">==</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"\"","startIndex":20,"endIndex":21,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"hmc","startIndex":21,"endIndex":24,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">hmc</span>"},{"text":"\"","startIndex":24,"endIndex":25,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":":","startIndex":25,"endIndex":26,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">elif</span><span class=\"mtk1\"> sampler == </span><span class=\"mtk8\">&quot;hmc&quot;</span><span class=\"mtk1\">:</span></span></span>"},{"text":"        kernel = tfp.mcmc.HamiltonianMonteCarlo(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"kernel","startIndex":8,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":15,"endIndex":16,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":17,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":20,"endIndex":21,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"mcmc","startIndex":21,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">mcmc</span>"},{"text":".","startIndex":25,"endIndex":26,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"HamiltonianMonteCarlo","startIndex":26,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">HamiltonianMonteCarlo</span>"},{"text":"(","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        kernel = tfp.mcmc.HamiltonianMonteCarlo(</span></span></span>"},{"text":"            target_log_prob_fn,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"target_log_prob_fn","startIndex":12,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">target_log_prob_fn</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            target_log_prob_fn,</span></span></span>"},{"text":"            step_size=step_size,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"step_size","startIndex":12,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step_size</span>"},{"text":"=","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"step_size","startIndex":22,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size</span>"},{"text":",","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">step_size</span><span class=\"mtk1\">=step_size,</span></span></span>"},{"text":"            num_leapfrog_steps=num_leapfrog_steps,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"num_leapfrog_steps","startIndex":12,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_leapfrog_steps</span>"},{"text":"=","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"num_leapfrog_steps","startIndex":31,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">num_leapfrog_steps</span>"},{"text":",","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">num_leapfrog_steps</span><span class=\"mtk1\">=num_leapfrog_steps,</span></span></span>"},{"text":"        )","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":")","startIndex":8,"endIndex":9,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>"},{"text":"        adaptive_kernel = step_size_adapter(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"adaptive_kernel","startIndex":8,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">adaptive_kernel</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":24,"endIndex":25,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"step_size_adapter","startIndex":26,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step_size_adapter</span>"},{"text":"(","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        adaptive_kernel = step_size_adapter(</span></span></span>"},{"text":"            kernel, num_adaptation_steps=num_burnin_steps","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"kernel","startIndex":12,"endIndex":18,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kernel</span>"},{"text":",","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"num_adaptation_steps","startIndex":20,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_adaptation_steps</span>"},{"text":"=","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"num_burnin_steps","startIndex":41,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">num_burnin_steps</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            kernel, </span><span class=\"mtk12\">num_adaptation_steps</span><span class=\"mtk1\">=num_burnin_steps</span></span></span>"},{"text":"        )","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":")","startIndex":8,"endIndex":9,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    if resume:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"if","startIndex":4,"endIndex":6,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"resume","startIndex":7,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">resume</span>"},{"text":":","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> resume:</span></span></span>"},{"text":"        prev_chain, prev_trace, prev_kernel_results = resume","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"prev_chain","startIndex":8,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_chain</span>"},{"text":",","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"prev_trace","startIndex":20,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_trace</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":31,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"prev_kernel_results","startIndex":32,"endIndex":51,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_kernel_results</span>"},{"text":" ","startIndex":51,"endIndex":52,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":52,"endIndex":53,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":53,"endIndex":54,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"resume","startIndex":54,"endIndex":60,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">resume</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        prev_chain, prev_trace, prev_kernel_results = resume</span></span></span>"},{"text":"        step = len(prev_chain)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"step","startIndex":8,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":13,"endIndex":14,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"len","startIndex":15,"endIndex":18,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">len</span>"},{"text":"(","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"prev_chain","startIndex":19,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_chain</span>"},{"text":")","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        step = </span><span class=\"mtk11\">len</span><span class=\"mtk1\">(prev_chain)</span></span></span>"},{"text":"        current_state = tf.nest.map_structure(lambda chain: chain[-1], prev_chain)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"current_state","startIndex":8,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">current_state</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":22,"endIndex":23,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":24,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":26,"endIndex":27,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"nest","startIndex":27,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nest</span>"},{"text":".","startIndex":31,"endIndex":32,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"map_structure","startIndex":32,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map_structure</span>"},{"text":"(","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"lambda","startIndex":46,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chain","startIndex":53,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">chain</span>"},{"text":":","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chain","startIndex":60,"endIndex":65,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":"[","startIndex":65,"endIndex":66,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"-","startIndex":66,"endIndex":67,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":67,"endIndex":68,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":"]","startIndex":68,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":",","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"prev_chain","startIndex":71,"endIndex":81,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_chain</span>"},{"text":")","startIndex":81,"endIndex":82,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        current_state = tf.nest.map_structure(</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">chain</span><span class=\"mtk1\">: chain[-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">], prev_chain)</span></span></span>"},{"text":"    else:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"else","startIndex":4,"endIndex":8,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">else</span>"},{"text":":","startIndex":8,"endIndex":9,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">else</span><span class=\"mtk1\">:</span></span></span>"},{"text":"        prev_kernel_results = adaptive_kernel.bootstrap_results(current_state)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"prev_kernel_results","startIndex":8,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_kernel_results</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":28,"endIndex":29,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"adaptive_kernel","startIndex":30,"endIndex":45,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">adaptive_kernel</span>"},{"text":".","startIndex":45,"endIndex":46,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"bootstrap_results","startIndex":46,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bootstrap_results</span>"},{"text":"(","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"current_state","startIndex":64,"endIndex":77,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">current_state</span>"},{"text":")","startIndex":77,"endIndex":78,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        prev_kernel_results = adaptive_kernel.bootstrap_results(current_state)</span></span></span>"},{"text":"        step = 0","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"step","startIndex":8,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":13,"endIndex":14,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0","startIndex":15,"endIndex":16,"scopes":["source.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        step = </span><span class=\"mtk7\">0</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    tf.summary.trace_on(graph=True, profiler=False)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"tf","startIndex":4,"endIndex":6,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":6,"endIndex":7,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"summary","startIndex":7,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary</span>"},{"text":".","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"trace_on","startIndex":15,"endIndex":23,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace_on</span>"},{"text":"(","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"graph","startIndex":24,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">graph</span>"},{"text":"=","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"True","startIndex":30,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">True</span>"},{"text":",","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"profiler","startIndex":36,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">profiler</span>"},{"text":"=","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"False","startIndex":45,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">False</span>"},{"text":")","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tf.summary.trace_on(</span><span class=\"mtk12\">graph</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">, </span><span class=\"mtk12\">profiler</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    chain, trace, final_kernel_results = sample_chain(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"chain","startIndex":4,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":",","startIndex":9,"endIndex":10,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"trace","startIndex":11,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":",","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"final_kernel_results","startIndex":18,"endIndex":38,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">final_kernel_results</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":39,"endIndex":40,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":40,"endIndex":41,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"sample_chain","startIndex":41,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sample_chain</span>"},{"text":"(","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    chain, trace, final_kernel_results = sample_chain(</span></span></span>"},{"text":"        kernel=adaptive_kernel,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"kernel","startIndex":8,"endIndex":14,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">kernel</span>"},{"text":"=","startIndex":14,"endIndex":15,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"adaptive_kernel","startIndex":15,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">adaptive_kernel</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">kernel</span><span class=\"mtk1\">=adaptive_kernel,</span></span></span>"},{"text":"        current_state=current_state,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"current_state","startIndex":8,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">current_state</span>"},{"text":"=","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"current_state","startIndex":22,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">current_state</span>"},{"text":",","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">=current_state,</span></span></span>"},{"text":"        previous_kernel_results=prev_kernel_results,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"previous_kernel_results","startIndex":8,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">previous_kernel_results</span>"},{"text":"=","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"prev_kernel_results","startIndex":32,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_kernel_results</span>"},{"text":",","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">previous_kernel_results</span><span class=\"mtk1\">=prev_kernel_results,</span></span></span>"},{"text":"        num_results=num_burnin_steps + num_results,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"num_results","startIndex":8,"endIndex":19,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">num_results</span>"},{"text":"=","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"num_burnin_steps","startIndex":20,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">num_burnin_steps</span>"},{"text":" ","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"num_results","startIndex":39,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">num_results</span>"},{"text":",","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">num_results</span><span class=\"mtk1\">=num_burnin_steps + num_results,</span></span></span>"},{"text":"        trace_fn=ft.partial(trace_fn, summary_freq=20),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"trace_fn","startIndex":8,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">trace_fn</span>"},{"text":"=","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"ft","startIndex":17,"endIndex":19,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">ft</span>"},{"text":".","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"partial","startIndex":20,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">partial</span>"},{"text":"(","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"trace_fn","startIndex":28,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace_fn</span>"},{"text":",","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"summary_freq","startIndex":38,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">summary_freq</span>"},{"text":"=","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"20","startIndex":51,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">20</span>"},{"text":")","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">trace_fn</span><span class=\"mtk1\">=ft.partial(trace_fn, </span><span class=\"mtk12\">summary_freq</span><span class=\"mtk1\">=</span><span class=\"mtk7\">20</span><span class=\"mtk1\">),</span></span></span>"},{"text":"        return_final_kernel_results=True,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"return_final_kernel_results","startIndex":8,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">return_final_kernel_results</span>"},{"text":"=","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"True","startIndex":36,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">True</span>"},{"text":",","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">return_final_kernel_results</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">,</span></span></span>"},{"text":"        **kwargs,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"**","startIndex":8,"endIndex":10,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">**</span>"},{"text":"kwargs","startIndex":10,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">kwargs</span>"},{"text":",","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        **kwargs,</span></span></span>"},{"text":"    )","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":")","startIndex":4,"endIndex":5,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    with summary_writer.as_default():","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"with","startIndex":4,"endIndex":8,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">with</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"summary_writer","startIndex":9,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary_writer</span>"},{"text":".","startIndex":23,"endIndex":24,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"as_default","startIndex":24,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">as_default</span>"},{"text":"(","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":36,"endIndex":37,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">with</span><span class=\"mtk1\"> summary_writer.as_default():</span></span></span>"},{"text":"        tf.summary.trace_export(name=\"hmc_trace\", step=step)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"tf","startIndex":8,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":10,"endIndex":11,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"summary","startIndex":11,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary</span>"},{"text":".","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"trace_export","startIndex":19,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace_export</span>"},{"text":"(","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"name","startIndex":32,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">name</span>"},{"text":"=","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"\"","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"hmc_trace","startIndex":38,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">hmc_trace</span>"},{"text":"\"","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":",","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"step","startIndex":50,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">step</span>"},{"text":"=","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"step","startIndex":55,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">step</span>"},{"text":")","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        tf.summary.trace_export(</span><span class=\"mtk12\">name</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;hmc_trace&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">step</span><span class=\"mtk1\">=step)</span></span></span>"},{"text":"    summary_writer.close()","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"summary_writer","startIndex":4,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">summary_writer</span>"},{"text":".","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"close","startIndex":19,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">close</span>"},{"text":"(","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    summary_writer.close()</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    if resume:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"if","startIndex":4,"endIndex":6,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"resume","startIndex":7,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">resume</span>"},{"text":":","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> resume:</span></span></span>"},{"text":"        chain = nest_concat(prev_chain, chain)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"chain","startIndex":8,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":" ","startIndex":13,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":14,"endIndex":15,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"nest_concat","startIndex":16,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nest_concat</span>"},{"text":"(","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"prev_chain","startIndex":28,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_chain</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chain","startIndex":40,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":")","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        chain = nest_concat(prev_chain, chain)</span></span></span>"},{"text":"        trace = nest_concat(prev_trace, trace)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"trace","startIndex":8,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":" ","startIndex":13,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":14,"endIndex":15,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"nest_concat","startIndex":16,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nest_concat</span>"},{"text":"(","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"prev_trace","startIndex":28,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prev_trace</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"trace","startIndex":40,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":")","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        trace = nest_concat(prev_trace, trace)</span></span></span>"},{"text":"    burnin, samples = zip(*[(t[:-num_results], t[-num_results:]) for t in chain])","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"burnin","startIndex":4,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">burnin</span>"},{"text":",","startIndex":10,"endIndex":11,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"samples","startIndex":12,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">samples</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":20,"endIndex":21,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"zip","startIndex":22,"endIndex":25,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">zip</span>"},{"text":"(","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"[","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"(","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.parenthesis.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"t","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">t</span>"},{"text":"[","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":":","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.slice.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":"-","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"num_results","startIndex":33,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">num_results</span>"},{"text":"]","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":",","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"t","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">t</span>"},{"text":"[","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"-","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"num_results","startIndex":50,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">num_results</span>"},{"text":":","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.slice.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":"]","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.parenthesis.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":64,"endIndex":65,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":65,"endIndex":68,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":68,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"t","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">t</span>"},{"text":" ","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":71,"endIndex":73,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":73,"endIndex":74,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chain","startIndex":74,"endIndex":79,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":"]","startIndex":79,"endIndex":80,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":80,"endIndex":81,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    burnin, samples = </span><span class=\"mtk11\">zip</span><span class=\"mtk1\">(*[(t[:-num_results], t[-num_results:]) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> t </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> chain])</span></span></span>"},{"text":"    return burnin, samples, trace, final_kernel_results","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"burnin","startIndex":11,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">burnin</span>"},{"text":",","startIndex":17,"endIndex":18,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"samples","startIndex":19,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">samples</span>"},{"text":",","startIndex":26,"endIndex":27,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"trace","startIndex":28,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":",","startIndex":33,"endIndex":34,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":34,"endIndex":35,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"final_kernel_results","startIndex":35,"endIndex":55,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">final_kernel_results</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> burnin, samples, trace, final_kernel_results</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def predict_from_chain(chain, X_test, uncertainty=\"aleatoric+epistemic\"):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"predict_from_chain","startIndex":4,"endIndex":22,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">predict_from_chain</span>"},{"text":"(","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"chain","startIndex":23,"endIndex":28,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">chain</span>"},{"text":",","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"X_test","startIndex":30,"endIndex":36,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">X_test</span>"},{"text":",","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"uncertainty","startIndex":38,"endIndex":49,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">uncertainty</span>"},{"text":"=","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"\"","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"aleatoric+epistemic","startIndex":51,"endIndex":70,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">aleatoric+epistemic</span>"},{"text":"\"","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function.python","meta.function.parameters.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":")","startIndex":71,"endIndex":72,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":72,"endIndex":73,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">predict_from_chain</span><span class=\"mtk1\">(</span><span class=\"mtk12\">chain</span><span class=\"mtk1\">, </span><span class=\"mtk12\">X_test</span><span class=\"mtk1\">, </span><span class=\"mtk12\">uncertainty</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;aleatoric+epistemic&quot;</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    \"\"\"Takes a Markov chain of NN configurations and does the actual","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"Takes a Markov chain of NN configurations and does the actual","startIndex":7,"endIndex":69,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Takes a Markov chain of NN configurations and does the actual</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Takes a Markov chain of NN configurations and does the actual</span></span></span>"},{"text":"    prediction on a test set X_test including aleatoric and optionally","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    prediction on a test set X_test including aleatoric and optionally","startIndex":0,"endIndex":71,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    prediction on a test set X_test including aleatoric and optionally</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    prediction on a test set X_test including aleatoric and optionally</span></span></span>"},{"text":"    epistemic uncertainty estimation.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    epistemic uncertainty estimation.","startIndex":0,"endIndex":38,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    epistemic uncertainty estimation.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    epistemic uncertainty estimation.</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    err = f\"unrecognized uncertainty type: {uncertainty}\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"err","startIndex":4,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">err</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":8,"endIndex":9,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"f","startIndex":10,"endIndex":11,"scopes":["source.python","meta.fstring.python","string.interpolated.python","string.quoted.single.python","storage.type.string.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16843306,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">f</span>"},{"text":"\"","startIndex":11,"endIndex":12,"scopes":["source.python","meta.fstring.python","punctuation.definition.string.begin.python","string.interpolated.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"unrecognized uncertainty type: ","startIndex":12,"endIndex":43,"scopes":["source.python","meta.fstring.python","string.interpolated.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">unrecognized uncertainty type: </span>"},{"text":"{","startIndex":43,"endIndex":44,"scopes":["source.python","meta.fstring.python","constant.character.format.placeholder.other.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">{</span>"},{"text":"uncertainty","startIndex":44,"endIndex":55,"scopes":["source.python","meta.fstring.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">uncertainty</span>"},{"text":"}","startIndex":55,"endIndex":56,"scopes":["source.python","meta.fstring.python","constant.character.format.placeholder.other.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">}</span>"},{"text":"\"","startIndex":56,"endIndex":57,"scopes":["source.python","meta.fstring.python","punctuation.definition.string.end.python","string.interpolated.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    err = </span><span class=\"mtk4\">f</span><span class=\"mtk8\">&quot;unrecognized uncertainty type: </span><span class=\"mtk4\">{</span><span class=\"mtk1\">uncertainty</span><span class=\"mtk4\">}</span><span class=\"mtk8\">&quot;</span></span></span>"},{"text":"    assert uncertainty in [\"aleatoric\", \"aleatoric+epistemic\"], err","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"assert","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">assert</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"uncertainty","startIndex":11,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">uncertainty</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":23,"endIndex":25,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":26,"endIndex":27,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"\"","startIndex":27,"endIndex":28,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"aleatoric","startIndex":28,"endIndex":37,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">aleatoric</span>"},{"text":"\"","startIndex":37,"endIndex":38,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"\"","startIndex":40,"endIndex":41,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"aleatoric+epistemic","startIndex":41,"endIndex":60,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">aleatoric+epistemic</span>"},{"text":"\"","startIndex":60,"endIndex":61,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"]","startIndex":61,"endIndex":62,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":",","startIndex":62,"endIndex":63,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":63,"endIndex":64,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"err","startIndex":64,"endIndex":67,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">err</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">assert</span><span class=\"mtk1\"> uncertainty </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&quot;aleatoric&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;aleatoric+epistemic&quot;</span><span class=\"mtk1\">], err</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    if uncertainty == \"aleatoric\":","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"if","startIndex":4,"endIndex":6,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"uncertainty","startIndex":7,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">uncertainty</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"==","startIndex":19,"endIndex":21,"scopes":["source.python","keyword.operator.comparison.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">==</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"\"","startIndex":22,"endIndex":23,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"aleatoric","startIndex":23,"endIndex":32,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">aleatoric</span>"},{"text":"\"","startIndex":32,"endIndex":33,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":":","startIndex":33,"endIndex":34,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> uncertainty == </span><span class=\"mtk8\">&quot;aleatoric&quot;</span><span class=\"mtk1\">:</span></span></span>"},{"text":"        post_params = [tf.reduce_mean(t, axis=0) for t in chain]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"post_params","startIndex":8,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">post_params</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":20,"endIndex":21,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"tf","startIndex":23,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":25,"endIndex":26,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"reduce_mean","startIndex":26,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">reduce_mean</span>"},{"text":"(","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"t","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">t</span>"},{"text":",","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"axis","startIndex":41,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">axis</span>"},{"text":"=","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"0","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":")","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":48,"endIndex":49,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":49,"endIndex":52,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":52,"endIndex":53,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"t","startIndex":53,"endIndex":54,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">t</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":55,"endIndex":57,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":57,"endIndex":58,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chain","startIndex":58,"endIndex":63,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":"]","startIndex":63,"endIndex":64,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        post_params = [tf.reduce_mean(t, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> t </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> chain]</span></span></span>"},{"text":"        post_model = build_net(post_params)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"post_model","startIndex":8,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">post_model</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":19,"endIndex":20,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"build_net","startIndex":21,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">build_net</span>"},{"text":"(","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"post_params","startIndex":31,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">post_params</span>"},{"text":")","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        post_model = build_net(post_params)</span></span></span>"},{"text":"        y_pred, y_var = post_model(X_test, training=False)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"y_pred","startIndex":8,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":",","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var","startIndex":16,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":22,"endIndex":23,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"post_model","startIndex":24,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">post_model</span>"},{"text":"(","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X_test","startIndex":35,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_test</span>"},{"text":",","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"training","startIndex":43,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">training</span>"},{"text":"=","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"False","startIndex":52,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">False</span>"},{"text":")","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_pred, y_var = post_model(X_test, </span><span class=\"mtk12\">training</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"        return y_pred.numpy(), y_var.numpy()","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"return","startIndex":8,"endIndex":14,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_pred","startIndex":15,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":".","startIndex":21,"endIndex":22,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"numpy","startIndex":22,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">numpy</span>"},{"text":"(","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":29,"endIndex":30,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var","startIndex":31,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var</span>"},{"text":".","startIndex":36,"endIndex":37,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"numpy","startIndex":37,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">numpy</span>"},{"text":"(","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> y_pred.numpy(), y_var.numpy()</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    if uncertainty == \"aleatoric+epistemic\":","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"if","startIndex":4,"endIndex":6,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"uncertainty","startIndex":7,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">uncertainty</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"==","startIndex":19,"endIndex":21,"scopes":["source.python","keyword.operator.comparison.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">==</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"\"","startIndex":22,"endIndex":23,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"aleatoric+epistemic","startIndex":23,"endIndex":42,"scopes":["source.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">aleatoric+epistemic</span>"},{"text":"\"","startIndex":42,"endIndex":43,"scopes":["source.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":":","startIndex":43,"endIndex":44,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> uncertainty == </span><span class=\"mtk8\">&quot;aleatoric+epistemic&quot;</span><span class=\"mtk1\">:</span></span></span>"},{"text":"        restructured_chain = [","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"restructured_chain","startIndex":8,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">restructured_chain</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":27,"endIndex":28,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":28,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":29,"endIndex":30,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        restructured_chain = [</span></span></span>"},{"text":"            [tensor[i] for tensor in chain] for i in range(len(chain[0]))","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"[","startIndex":12,"endIndex":13,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"tensor","startIndex":13,"endIndex":19,"scopes":["source.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensor</span>"},{"text":"[","startIndex":19,"endIndex":20,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"i","startIndex":20,"endIndex":21,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">i</span>"},{"text":"]","startIndex":21,"endIndex":22,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":23,"endIndex":26,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensor","startIndex":27,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensor</span>"},{"text":" ","startIndex":33,"endIndex":34,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":34,"endIndex":36,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":36,"endIndex":37,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chain","startIndex":37,"endIndex":42,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":"]","startIndex":42,"endIndex":43,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":44,"endIndex":47,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":47,"endIndex":48,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"i","startIndex":48,"endIndex":49,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">i</span>"},{"text":" ","startIndex":49,"endIndex":50,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":50,"endIndex":52,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":52,"endIndex":53,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"range","startIndex":53,"endIndex":58,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">range</span>"},{"text":"(","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"len","startIndex":59,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">len</span>"},{"text":"(","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"chain","startIndex":63,"endIndex":68,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chain</span>"},{"text":"[","startIndex":68,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"0","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":"]","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":71,"endIndex":72,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":72,"endIndex":73,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            [tensor[i] </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> tensor </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> chain] </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> i </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">range</span><span class=\"mtk1\">(</span><span class=\"mtk11\">len</span><span class=\"mtk1\">(chain[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">]))</span></span></span>"},{"text":"        ]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"]","startIndex":8,"endIndex":9,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ]</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"        def predict(params):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"def","startIndex":8,"endIndex":11,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"predict","startIndex":12,"endIndex":19,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">predict</span>"},{"text":"(","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"params","startIndex":20,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">params</span>"},{"text":")","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">predict</span><span class=\"mtk1\">(</span><span class=\"mtk12\">params</span><span class=\"mtk1\">):</span></span></span>"},{"text":"            post_model = build_net(params)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"post_model","startIndex":12,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">post_model</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":23,"endIndex":24,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":24,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"build_net","startIndex":25,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">build_net</span>"},{"text":"(","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"params","startIndex":35,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":")","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            post_model = build_net(params)</span></span></span>"},{"text":"            y_pred, y_var = post_model(X_test, training=False)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"y_pred","startIndex":12,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":",","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var","startIndex":20,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":26,"endIndex":27,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"post_model","startIndex":28,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">post_model</span>"},{"text":"(","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X_test","startIndex":39,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_test</span>"},{"text":",","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"training","startIndex":47,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">training</span>"},{"text":"=","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"False","startIndex":56,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">False</span>"},{"text":")","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            y_pred, y_var = post_model(X_test, </span><span class=\"mtk12\">training</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>"},{"text":"            return y_pred, y_var","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"return","startIndex":12,"endIndex":18,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_pred","startIndex":19,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":",","startIndex":25,"endIndex":26,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var","startIndex":27,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> y_pred, y_var</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"        preds = [predict(chunks(params, 2)) for params in restructured_chain]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"preds","startIndex":8,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">preds</span>"},{"text":" ","startIndex":13,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":14,"endIndex":15,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"predict","startIndex":17,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">predict</span>"},{"text":"(","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"chunks","startIndex":25,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chunks</span>"},{"text":"(","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"params","startIndex":32,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"2","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":")","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":44,"endIndex":47,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":47,"endIndex":48,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"params","startIndex":48,"endIndex":54,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":55,"endIndex":57,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":57,"endIndex":58,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"restructured_chain","startIndex":58,"endIndex":76,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">restructured_chain</span>"},{"text":"]","startIndex":76,"endIndex":77,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        preds = [predict(chunks(params, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">)) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> params </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> restructured_chain]</span></span></span>"},{"text":"        y_pred_mc_samples, y_var_mc_samples = tf.unstack(preds, axis=1,)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"y_pred_mc_samples","startIndex":8,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred_mc_samples</span>"},{"text":",","startIndex":25,"endIndex":26,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var_mc_samples","startIndex":27,"endIndex":43,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var_mc_samples</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":44,"endIndex":45,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":45,"endIndex":46,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":46,"endIndex":48,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":48,"endIndex":49,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"unstack","startIndex":49,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">unstack</span>"},{"text":"(","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"preds","startIndex":57,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">preds</span>"},{"text":",","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"axis","startIndex":64,"endIndex":68,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">axis</span>"},{"text":"=","startIndex":68,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"1","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":",","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":")","startIndex":71,"endIndex":72,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_pred_mc_samples, y_var_mc_samples = tf.unstack(preds, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1</span><span class=\"mtk1\">,)</span></span></span>"},{"text":"        y_pred, y_var_epist = tf.nn.moments(y_pred_mc_samples, axes=0)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"y_pred","startIndex":8,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":",","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var_epist","startIndex":16,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var_epist</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":28,"endIndex":29,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":30,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":32,"endIndex":33,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"nn","startIndex":33,"endIndex":35,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nn</span>"},{"text":".","startIndex":35,"endIndex":36,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"moments","startIndex":36,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">moments</span>"},{"text":"(","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"y_pred_mc_samples","startIndex":44,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred_mc_samples</span>"},{"text":",","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"axes","startIndex":63,"endIndex":67,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">axes</span>"},{"text":"=","startIndex":67,"endIndex":68,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"0","startIndex":68,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":")","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_pred, y_var_epist = tf.nn.moments(y_pred_mc_samples, </span><span class=\"mtk12\">axes</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)</span></span></span>"},{"text":"        y_var_aleat = tf.reduce_mean(y_var_mc_samples, axis=0)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"y_var_aleat","startIndex":8,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var_aleat</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":20,"endIndex":21,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":22,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":24,"endIndex":25,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"reduce_mean","startIndex":25,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">reduce_mean</span>"},{"text":"(","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"y_var_mc_samples","startIndex":37,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var_mc_samples</span>"},{"text":",","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"axis","startIndex":55,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">axis</span>"},{"text":"=","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"0","startIndex":60,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":")","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_var_aleat = tf.reduce_mean(y_var_mc_samples, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">)</span></span></span>"},{"text":"        y_var_tot = y_var_epist + y_var_aleat","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"y_var_tot","startIndex":8,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var_tot</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":18,"endIndex":19,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var_epist","startIndex":20,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var_epist</span>"},{"text":" ","startIndex":31,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+","startIndex":32,"endIndex":33,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+</span>"},{"text":" ","startIndex":33,"endIndex":34,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var_aleat","startIndex":34,"endIndex":45,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var_aleat</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_var_tot = y_var_epist + y_var_aleat</span></span></span>"},{"text":"        return y_pred, y_var_tot","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"return","startIndex":8,"endIndex":14,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_pred","startIndex":15,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":",","startIndex":21,"endIndex":22,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var_tot","startIndex":23,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var_tot</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> y_pred, y_var_tot</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def nest_concat(*args, axis=0):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"nest_concat","startIndex":4,"endIndex":15,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">nest_concat</span>"},{"text":"(","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.unpacking.parameter.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"args","startIndex":17,"endIndex":21,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">args</span>"},{"text":",","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"axis","startIndex":23,"endIndex":27,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">axis</span>"},{"text":"=","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"0","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":")","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">nest_concat</span><span class=\"mtk1\">(*</span><span class=\"mtk12\">args</span><span class=\"mtk1\">, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    \"\"\"Utility function for concatenating a new Markov chain or trace with","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"Utility function for concatenating a new Markov chain or trace with","startIndex":7,"endIndex":75,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Utility function for concatenating a new Markov chain or trace with</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Utility function for concatenating a new Markov chain or trace with</span></span></span>"},{"text":"    older ones when resuming a previous calculation.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    older ones when resuming a previous calculation.","startIndex":0,"endIndex":53,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    older ones when resuming a previous calculation.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    older ones when resuming a previous calculation.</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    return tf.nest.map_structure(lambda *parts: tf.concat(parts, axis=axis), *args)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":11,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"nest","startIndex":14,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nest</span>"},{"text":".","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"map_structure","startIndex":19,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map_structure</span>"},{"text":"(","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"lambda","startIndex":33,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"*","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","keyword.operator.unpacking.parameter.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"parts","startIndex":41,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">parts</span>"},{"text":":","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":48,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"concat","startIndex":51,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">concat</span>"},{"text":"(","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"parts","startIndex":58,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">parts</span>"},{"text":",","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":64,"endIndex":65,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"axis","startIndex":65,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">axis</span>"},{"text":"=","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"axis","startIndex":70,"endIndex":74,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">axis</span>"},{"text":")","startIndex":74,"endIndex":75,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":75,"endIndex":76,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":76,"endIndex":77,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"*","startIndex":77,"endIndex":78,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"args","startIndex":78,"endIndex":82,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">args</span>"},{"text":")","startIndex":82,"endIndex":83,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tf.nest.map_structure(</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> *</span><span class=\"mtk12\">parts</span><span class=\"mtk1\">: tf.concat(parts, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=axis), *args)</span></span></span>"}],"id":"4b85744a-6dd2-562c-a793-37e857ac5d80","parent":"c0e1786f-a24c-5cb8-8f6d-ac33c4b0dfed","internal":{"type":"GRVSCCodeBlock","contentDigest":"7b1136b32e85a61b8b2af19ff1154e18","counter":1027,"owner":"gatsby-plugin-mdx"},"children":[]},{"index":3,"text":"import functools as ft\n\nimport tensorflow as tf\nimport tensorflow_probability as tfp\n\n\ndef dense(inputs, w, b, activation=tf.identity):\n    return activation(tf.matmul(inputs, w) + b)\n\n\ndef build_net(params, activation=tf.nn.relu):\n    def model(X, training=True):\n        for w, b in params[:-1]:\n            X = dense(X, w, b, activation)\n        # final linear layer\n        X = dense(X, *params[-1])\n        y_pred, y_log_var = tf.unstack(X, axis=-1)\n        y_var = tf.exp(y_log_var)\n        if training:\n            return tfp.distributions.Normal(loc=y_pred, scale=tf.sqrt(y_var))\n        return y_pred, y_var\n\n    return model\n\n\ndef bnn_log_prob_fn(X, y, params, get_mean=False):\n    \"\"\"Compute log likelihood of predicted labels y given features X and params.\n\n    Args:\n        X (np.array): 2d feature values.\n        y (np.array): 1d labels (ground truth).\n        params (list): [[w1, b1], ...] containing 2d/1d arrays for weights/biases.\n        get_mean (bool, optional): Whether to return the mean log\n            probability over all labels for diagnostics, e.g. to\n            compare train and test set performance.\n\n    Returns:\n        tf.tensor: Sum or mean of log probabilities of all labels.\n    \"\"\"\n    net = build_net(params)\n    labels_dist = net(X)\n    if get_mean:\n        return tf.reduce_mean(labels_dist.log_prob(y))\n    return tf.reduce_sum(labels_dist.log_prob(y))\n\n\ndef prior_log_prob_fn(w_prior, b_prior, params):\n    log_prob = 0\n    for w, b in params:\n        log_prob += tf.reduce_sum(w_prior.log_prob(w))\n        log_prob += tf.reduce_sum(b_prior.log_prob(b))\n    return log_prob\n\n\ndef target_log_prob_fn_factory(w_prior, b_prior, X_train, y_train):\n    # This signature is forced by TFP's HMC kernel which calls log_prob_fn(*chains).\n    def target_log_prob_fn(*params):\n        if not isinstance(params[0], (list, tuple)):\n            params = chunks(params, 2)\n        log_prob = prior_log_prob_fn(w_prior, b_prior, params)\n        log_prob += bnn_log_prob_fn(X_train, y_train, params)\n        return log_prob\n\n    return target_log_prob_fn\n\n\ndef tracer_factory(X, y):\n    return lambda params: ft.partial(bnn_log_prob_fn, X, y, get_mean=True)(params)\n\n\ndef chunks(lst, n):\n    # Subdivide lst into successive n-sized chunks.\n    return [lst[i : i + n] for i in range(0, len(lst), n)]\n\n\ndef get_random_initial_state(w_prior, b_prior, nodes_per_layer, overdisp=1.0):\n    \"\"\"Draw random samples for weights and biases of a NN according to some\n    specified priors. distributions. This set of parameter values can serve as a\n    starting point for MCMC or gradient descent training.\n    \"\"\"\n    init_state = []\n    for n1, n2 in zip(nodes_per_layer, nodes_per_layer[1:]):\n        w_shape, b_shape = [n1, n2], n2\n        # Use overdispersion > 1 for better R-hat statistics.\n        w = w_prior.sample(w_shape) * overdisp\n        b = b_prior.sample(b_shape) * overdisp\n        init_state.append([tf.Variable(w), tf.Variable(b)])\n    return init_state","meta":{},"html":"<pre class=\"grvsc-container default-dark\" data-language=\"py\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> functools </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> ft</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow_probability </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tfp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">dense</span><span class=\"mtk1\">(</span><span class=\"mtk12\">inputs</span><span class=\"mtk1\">, </span><span class=\"mtk12\">w</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b</span><span class=\"mtk1\">, </span><span class=\"mtk12\">activation</span><span class=\"mtk1\">=tf.identity):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> activation(tf.matmul(inputs, w) + b)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">build_net</span><span class=\"mtk1\">(</span><span class=\"mtk12\">params</span><span class=\"mtk1\">, </span><span class=\"mtk12\">activation</span><span class=\"mtk1\">=tf.nn.relu):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">model</span><span class=\"mtk1\">(</span><span class=\"mtk12\">X</span><span class=\"mtk1\">, </span><span class=\"mtk12\">training</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> w, b </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> params[:-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            X = dense(X, w, b, activation)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># final linear layer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        X = dense(X, *params[-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_pred, y_log_var = tf.unstack(X, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_var = tf.exp(y_log_var)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> training:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tfp.distributions.Normal(</span><span class=\"mtk12\">loc</span><span class=\"mtk1\">=y_pred, </span><span class=\"mtk12\">scale</span><span class=\"mtk1\">=tf.sqrt(y_var))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> y_pred, y_var</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">bnn_log_prob_fn</span><span class=\"mtk1\">(</span><span class=\"mtk12\">X</span><span class=\"mtk1\">, </span><span class=\"mtk12\">y</span><span class=\"mtk1\">, </span><span class=\"mtk12\">params</span><span class=\"mtk1\">, </span><span class=\"mtk12\">get_mean</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Compute log likelihood of predicted labels y given features X and params.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Args:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        X (np.array): 2d feature values.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        y (np.array): 1d labels (ground truth).</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        params (list): [[w1, b1], ...] containing 2d/1d arrays for weights/biases.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        get_mean (bool, optional): Whether to return the mean log</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">            probability over all labels for diagnostics, e.g. to</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">            compare train and test set performance.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Returns:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        tf.tensor: Sum or mean of log probabilities of all labels.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    net = build_net(params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    labels_dist = net(X)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> get_mean:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tf.reduce_mean(labels_dist.log_prob(y))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tf.reduce_sum(labels_dist.log_prob(y))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">prior_log_prob_fn</span><span class=\"mtk1\">(</span><span class=\"mtk12\">w_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">params</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    log_prob = </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> w, b </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> params:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        log_prob += tf.reduce_sum(w_prior.log_prob(w))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        log_prob += tf.reduce_sum(b_prior.log_prob(b))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> log_prob</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">target_log_prob_fn_factory</span><span class=\"mtk1\">(</span><span class=\"mtk12\">w_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">X_train</span><span class=\"mtk1\">, </span><span class=\"mtk12\">y_train</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># This signature is forced by TFP&#39;s HMC kernel which calls log_prob_fn(*chains).</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">target_log_prob_fn</span><span class=\"mtk1\">(*</span><span class=\"mtk12\">params</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk4\">not</span><span class=\"mtk1\"> </span><span class=\"mtk11\">isinstance</span><span class=\"mtk1\">(params[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">], (</span><span class=\"mtk10\">list</span><span class=\"mtk1\">, </span><span class=\"mtk10\">tuple</span><span class=\"mtk1\">)):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            params = chunks(params, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        log_prob = prior_log_prob_fn(w_prior, b_prior, params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        log_prob += bnn_log_prob_fn(X_train, y_train, params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> log_prob</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> target_log_prob_fn</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">tracer_factory</span><span class=\"mtk1\">(</span><span class=\"mtk12\">X</span><span class=\"mtk1\">, </span><span class=\"mtk12\">y</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">params</span><span class=\"mtk1\">: ft.partial(bnn_log_prob_fn, X, y, </span><span class=\"mtk12\">get_mean</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">)(params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">chunks</span><span class=\"mtk1\">(</span><span class=\"mtk12\">lst</span><span class=\"mtk1\">, </span><span class=\"mtk12\">n</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Subdivide lst into successive n-sized chunks.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> [lst[i : i + n] </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> i </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">range</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk11\">len</span><span class=\"mtk1\">(lst), n)]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">get_random_initial_state</span><span class=\"mtk1\">(</span><span class=\"mtk12\">w_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">nodes_per_layer</span><span class=\"mtk1\">, </span><span class=\"mtk12\">overdisp</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1.0</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Draw random samples for weights and biases of a NN according to some</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    specified priors. distributions. This set of parameter values can serve as a</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    starting point for MCMC or gradient descent training.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    init_state = []</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> n1, n2 </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">zip</span><span class=\"mtk1\">(nodes_per_layer, nodes_per_layer[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">:]):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        w_shape, b_shape = [n1, n2], n2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># Use overdispersion &gt; 1 for better R-hat statistics.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        w = w_prior.sample(w_shape) * overdisp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        b = b_prior.sample(b_shape) * overdisp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        init_state.append([tf.Variable(w), tf.Variable(b)])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> init_state</span></span></span></code></pre>","preClassName":"grvsc-container default-dark","codeClassName":"grvsc-code","language":"py","defaultTheme":{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]},"additionalThemes":[{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]}],"tokenizedLines":[{"text":"import functools as ft","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"functools","startIndex":7,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">functools</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":17,"endIndex":19,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"ft","startIndex":20,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">ft</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> functools </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> ft</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"import tensorflow as tf","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow","startIndex":7,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":18,"endIndex":20,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":21,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>"},{"text":"import tensorflow_probability as tfp","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow_probability","startIndex":7,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow_probability</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":30,"endIndex":32,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":32,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":33,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow_probability </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tfp</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def dense(inputs, w, b, activation=tf.identity):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"dense","startIndex":4,"endIndex":9,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">dense</span>"},{"text":"(","startIndex":9,"endIndex":10,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"inputs","startIndex":10,"endIndex":16,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">inputs</span>"},{"text":",","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"w","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">w</span>"},{"text":",","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">b</span>"},{"text":",","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"activation","startIndex":24,"endIndex":34,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">activation</span>"},{"text":"=","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"tf","startIndex":35,"endIndex":37,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"identity","startIndex":38,"endIndex":46,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">identity</span>"},{"text":")","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">dense</span><span class=\"mtk1\">(</span><span class=\"mtk12\">inputs</span><span class=\"mtk1\">, </span><span class=\"mtk12\">w</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b</span><span class=\"mtk1\">, </span><span class=\"mtk12\">activation</span><span class=\"mtk1\">=tf.identity):</span></span></span>"},{"text":"    return activation(tf.matmul(inputs, w) + b)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"activation","startIndex":11,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">activation</span>"},{"text":"(","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"tf","startIndex":22,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"matmul","startIndex":25,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">matmul</span>"},{"text":"(","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"inputs","startIndex":32,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">inputs</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"w","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w</span>"},{"text":")","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+</span>"},{"text":" ","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b</span>"},{"text":")","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> activation(tf.matmul(inputs, w) + b)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def build_net(params, activation=tf.nn.relu):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"build_net","startIndex":4,"endIndex":13,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">build_net</span>"},{"text":"(","startIndex":13,"endIndex":14,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"params","startIndex":14,"endIndex":20,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">params</span>"},{"text":",","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"activation","startIndex":22,"endIndex":32,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">activation</span>"},{"text":"=","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"tf","startIndex":33,"endIndex":35,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"nn","startIndex":36,"endIndex":38,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nn</span>"},{"text":".","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"relu","startIndex":39,"endIndex":43,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">relu</span>"},{"text":")","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">build_net</span><span class=\"mtk1\">(</span><span class=\"mtk12\">params</span><span class=\"mtk1\">, </span><span class=\"mtk12\">activation</span><span class=\"mtk1\">=tf.nn.relu):</span></span></span>"},{"text":"    def model(X, training=True):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"def","startIndex":4,"endIndex":7,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"model","startIndex":8,"endIndex":13,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">model</span>"},{"text":"(","startIndex":13,"endIndex":14,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X","startIndex":14,"endIndex":15,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">X</span>"},{"text":",","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"training","startIndex":17,"endIndex":25,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">training</span>"},{"text":"=","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"True","startIndex":26,"endIndex":30,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">True</span>"},{"text":")","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">model</span><span class=\"mtk1\">(</span><span class=\"mtk12\">X</span><span class=\"mtk1\">, </span><span class=\"mtk12\">training</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">):</span></span></span>"},{"text":"        for w, b in params[:-1]:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"for","startIndex":8,"endIndex":11,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"w","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w</span>"},{"text":",","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":17,"endIndex":19,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"params","startIndex":20,"endIndex":26,"scopes":["source.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":"[","startIndex":26,"endIndex":27,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":":","startIndex":27,"endIndex":28,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.slice.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":"-","startIndex":28,"endIndex":29,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":29,"endIndex":30,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":"]","startIndex":30,"endIndex":31,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":":","startIndex":31,"endIndex":32,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> w, b </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> params[:-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]:</span></span></span>"},{"text":"            X = dense(X, w, b, activation)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"X","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X</span>"},{"text":" ","startIndex":13,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":14,"endIndex":15,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"dense","startIndex":16,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">dense</span>"},{"text":"(","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X</span>"},{"text":",","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"w","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w</span>"},{"text":",","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b</span>"},{"text":",","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"activation","startIndex":31,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">activation</span>"},{"text":")","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            X = dense(X, w, b, activation)</span></span></span>"},{"text":"        # final linear layer","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"#","startIndex":8,"endIndex":9,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" final linear layer","startIndex":9,"endIndex":28,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> final linear layer</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># final linear layer</span></span></span>"},{"text":"        X = dense(X, *params[-1])","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"X","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":10,"endIndex":11,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"dense","startIndex":12,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">dense</span>"},{"text":"(","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X</span>"},{"text":",","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"*","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"params","startIndex":22,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":"[","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"-","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":"]","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        X = dense(X, *params[-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">])</span></span></span>"},{"text":"        y_pred, y_log_var = tf.unstack(X, axis=-1)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"y_pred","startIndex":8,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":",","startIndex":14,"endIndex":15,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_log_var","startIndex":16,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_log_var</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":26,"endIndex":27,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":28,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"unstack","startIndex":31,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">unstack</span>"},{"text":"(","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X</span>"},{"text":",","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"axis","startIndex":42,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">axis</span>"},{"text":"=","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"-","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":")","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_pred, y_log_var = tf.unstack(X, </span><span class=\"mtk12\">axis</span><span class=\"mtk1\">=-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)</span></span></span>"},{"text":"        y_var = tf.exp(y_log_var)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"y_var","startIndex":8,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var</span>"},{"text":" ","startIndex":13,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":14,"endIndex":15,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":16,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"exp","startIndex":19,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">exp</span>"},{"text":"(","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"y_log_var","startIndex":23,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_log_var</span>"},{"text":")","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        y_var = tf.exp(y_log_var)</span></span></span>"},{"text":"        if training:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"if","startIndex":8,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"training","startIndex":11,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">training</span>"},{"text":":","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> training:</span></span></span>"},{"text":"            return tfp.distributions.Normal(loc=y_pred, scale=tf.sqrt(y_var))","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"return","startIndex":12,"endIndex":18,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":19,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"distributions","startIndex":23,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">distributions</span>"},{"text":".","startIndex":36,"endIndex":37,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Normal","startIndex":37,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Normal</span>"},{"text":"(","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"loc","startIndex":44,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">loc</span>"},{"text":"=","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"y_pred","startIndex":48,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":",","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"scale","startIndex":56,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">scale</span>"},{"text":"=","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"tf","startIndex":62,"endIndex":64,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":64,"endIndex":65,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"sqrt","startIndex":65,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sqrt</span>"},{"text":"(","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"y_var","startIndex":70,"endIndex":75,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var</span>"},{"text":")","startIndex":75,"endIndex":76,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":76,"endIndex":77,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tfp.distributions.Normal(</span><span class=\"mtk12\">loc</span><span class=\"mtk1\">=y_pred, </span><span class=\"mtk12\">scale</span><span class=\"mtk1\">=tf.sqrt(y_var))</span></span></span>"},{"text":"        return y_pred, y_var","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"return","startIndex":8,"endIndex":14,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_pred","startIndex":15,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_pred</span>"},{"text":",","startIndex":21,"endIndex":22,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_var","startIndex":23,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_var</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> y_pred, y_var</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    return model","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"model","startIndex":11,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">model</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> model</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def bnn_log_prob_fn(X, y, params, get_mean=False):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bnn_log_prob_fn","startIndex":4,"endIndex":19,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">bnn_log_prob_fn</span>"},{"text":"(","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">X</span>"},{"text":",","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">y</span>"},{"text":",","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"params","startIndex":26,"endIndex":32,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">params</span>"},{"text":",","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_mean","startIndex":34,"endIndex":42,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">get_mean</span>"},{"text":"=","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"False","startIndex":43,"endIndex":48,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">False</span>"},{"text":")","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">bnn_log_prob_fn</span><span class=\"mtk1\">(</span><span class=\"mtk12\">X</span><span class=\"mtk1\">, </span><span class=\"mtk12\">y</span><span class=\"mtk1\">, </span><span class=\"mtk12\">params</span><span class=\"mtk1\">, </span><span class=\"mtk12\">get_mean</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    \"\"\"Compute log likelihood of predicted labels y given features X and params.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"Compute log likelihood of predicted labels y given features X and params.","startIndex":7,"endIndex":81,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Compute log likelihood of predicted labels y given features X and params.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Compute log likelihood of predicted labels y given features X and params.</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    Args:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    Args:","startIndex":0,"endIndex":10,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    Args:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Args:</span></span></span>"},{"text":"        X (np.array): 2d feature values.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        X (np.array): 2d feature values.","startIndex":0,"endIndex":41,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        X (np.array): 2d feature values.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        X (np.array): 2d feature values.</span></span></span>"},{"text":"        y (np.array): 1d labels (ground truth).","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        y (np.array): 1d labels (ground truth).","startIndex":0,"endIndex":48,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        y (np.array): 1d labels (ground truth).</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        y (np.array): 1d labels (ground truth).</span></span></span>"},{"text":"        params (list): [[w1, b1], ...] containing 2d/1d arrays for weights/biases.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        params (list): [[w1, b1], ...] containing 2d/1d arrays for weights/biases.","startIndex":0,"endIndex":83,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        params (list): [[w1, b1], ...] containing 2d/1d arrays for weights/biases.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        params (list): [[w1, b1], ...] containing 2d/1d arrays for weights/biases.</span></span></span>"},{"text":"        get_mean (bool, optional): Whether to return the mean log","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        get_mean (bool, optional): Whether to return the mean log","startIndex":0,"endIndex":66,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        get_mean (bool, optional): Whether to return the mean log</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        get_mean (bool, optional): Whether to return the mean log</span></span></span>"},{"text":"            probability over all labels for diagnostics, e.g. to","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            probability over all labels for diagnostics, e.g. to","startIndex":0,"endIndex":65,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">            probability over all labels for diagnostics, e.g. to</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">            probability over all labels for diagnostics, e.g. to</span></span></span>"},{"text":"            compare train and test set performance.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            compare train and test set performance.","startIndex":0,"endIndex":52,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">            compare train and test set performance.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">            compare train and test set performance.</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    Returns:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    Returns:","startIndex":0,"endIndex":13,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    Returns:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    Returns:</span></span></span>"},{"text":"        tf.tensor: Sum or mean of log probabilities of all labels.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        tf.tensor: Sum or mean of log probabilities of all labels.","startIndex":0,"endIndex":67,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">        tf.tensor: Sum or mean of log probabilities of all labels.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        tf.tensor: Sum or mean of log probabilities of all labels.</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    net = build_net(params)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"net","startIndex":4,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">net</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":8,"endIndex":9,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"build_net","startIndex":10,"endIndex":19,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">build_net</span>"},{"text":"(","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"params","startIndex":20,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":")","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    net = build_net(params)</span></span></span>"},{"text":"    labels_dist = net(X)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"labels_dist","startIndex":4,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">labels_dist</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":16,"endIndex":17,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"net","startIndex":18,"endIndex":21,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">net</span>"},{"text":"(","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X</span>"},{"text":")","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    labels_dist = net(X)</span></span></span>"},{"text":"    if get_mean:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"if","startIndex":4,"endIndex":6,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_mean","startIndex":7,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_mean</span>"},{"text":":","startIndex":15,"endIndex":16,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> get_mean:</span></span></span>"},{"text":"        return tf.reduce_mean(labels_dist.log_prob(y))","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"return","startIndex":8,"endIndex":14,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":15,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":17,"endIndex":18,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"reduce_mean","startIndex":18,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">reduce_mean</span>"},{"text":"(","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"labels_dist","startIndex":30,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">labels_dist</span>"},{"text":".","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"log_prob","startIndex":42,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":"(","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"y","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y</span>"},{"text":")","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tf.reduce_mean(labels_dist.log_prob(y))</span></span></span>"},{"text":"    return tf.reduce_sum(labels_dist.log_prob(y))","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":11,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"reduce_sum","startIndex":14,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">reduce_sum</span>"},{"text":"(","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"labels_dist","startIndex":25,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">labels_dist</span>"},{"text":".","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"log_prob","startIndex":37,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":"(","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"y","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y</span>"},{"text":")","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> tf.reduce_sum(labels_dist.log_prob(y))</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def prior_log_prob_fn(w_prior, b_prior, params):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"prior_log_prob_fn","startIndex":4,"endIndex":21,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">prior_log_prob_fn</span>"},{"text":"(","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"w_prior","startIndex":22,"endIndex":29,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">w_prior</span>"},{"text":",","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b_prior","startIndex":31,"endIndex":38,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">b_prior</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"params","startIndex":40,"endIndex":46,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">params</span>"},{"text":")","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">prior_log_prob_fn</span><span class=\"mtk1\">(</span><span class=\"mtk12\">w_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">params</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    log_prob = 0","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"log_prob","startIndex":4,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":13,"endIndex":14,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0","startIndex":15,"endIndex":16,"scopes":["source.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    log_prob = </span><span class=\"mtk7\">0</span></span></span>"},{"text":"    for w, b in params:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"for","startIndex":4,"endIndex":7,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"w","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w</span>"},{"text":",","startIndex":9,"endIndex":10,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":13,"endIndex":15,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"params","startIndex":16,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":":","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> w, b </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> params:</span></span></span>"},{"text":"        log_prob += tf.reduce_sum(w_prior.log_prob(w))","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"log_prob","startIndex":8,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+=","startIndex":17,"endIndex":19,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+=</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":20,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"reduce_sum","startIndex":23,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">reduce_sum</span>"},{"text":"(","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"w_prior","startIndex":34,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w_prior</span>"},{"text":".","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"log_prob","startIndex":42,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":"(","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"w","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w</span>"},{"text":")","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        log_prob += tf.reduce_sum(w_prior.log_prob(w))</span></span></span>"},{"text":"        log_prob += tf.reduce_sum(b_prior.log_prob(b))","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"log_prob","startIndex":8,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+=","startIndex":17,"endIndex":19,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+=</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":20,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"reduce_sum","startIndex":23,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">reduce_sum</span>"},{"text":"(","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"b_prior","startIndex":34,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b_prior</span>"},{"text":".","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"log_prob","startIndex":42,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":"(","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"b","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b</span>"},{"text":")","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        log_prob += tf.reduce_sum(b_prior.log_prob(b))</span></span></span>"},{"text":"    return log_prob","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"log_prob","startIndex":11,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> log_prob</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def target_log_prob_fn_factory(w_prior, b_prior, X_train, y_train):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"target_log_prob_fn_factory","startIndex":4,"endIndex":30,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">target_log_prob_fn_factory</span>"},{"text":"(","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"w_prior","startIndex":31,"endIndex":38,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">w_prior</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b_prior","startIndex":40,"endIndex":47,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">b_prior</span>"},{"text":",","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"X_train","startIndex":49,"endIndex":56,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">X_train</span>"},{"text":",","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_train","startIndex":58,"endIndex":65,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">y_train</span>"},{"text":")","startIndex":65,"endIndex":66,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":66,"endIndex":67,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">target_log_prob_fn_factory</span><span class=\"mtk1\">(</span><span class=\"mtk12\">w_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">X_train</span><span class=\"mtk1\">, </span><span class=\"mtk12\">y_train</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    # This signature is forced by TFP's HMC kernel which calls log_prob_fn(*chains).","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"#","startIndex":4,"endIndex":5,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" This signature is forced by TFP's HMC kernel which calls log_prob_fn(*chains).","startIndex":5,"endIndex":84,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> This signature is forced by TFP&#39;s HMC kernel which calls log_prob_fn(*chains).</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># This signature is forced by TFP&#39;s HMC kernel which calls log_prob_fn(*chains).</span></span></span>"},{"text":"    def target_log_prob_fn(*params):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"def","startIndex":4,"endIndex":7,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"target_log_prob_fn","startIndex":8,"endIndex":26,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">target_log_prob_fn</span>"},{"text":"(","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.unpacking.parameter.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"params","startIndex":28,"endIndex":34,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">params</span>"},{"text":")","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">target_log_prob_fn</span><span class=\"mtk1\">(*</span><span class=\"mtk12\">params</span><span class=\"mtk1\">):</span></span></span>"},{"text":"        if not isinstance(params[0], (list, tuple)):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"if","startIndex":8,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"not","startIndex":11,"endIndex":14,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">not</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"isinstance","startIndex":15,"endIndex":25,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">isinstance</span>"},{"text":"(","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"params","startIndex":26,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":"[","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"0","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":"]","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":",","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"(","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.parenthesis.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"list","startIndex":38,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","support.type.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk10","bold":false,"italic":false,"underline":false,"meta":16941098,"color":"#4EC9B0"},"additionalThemeTokenData":[],"className":"mtk10","html":"<span class=\"mtk10\">list</span>"},{"text":",","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tuple","startIndex":44,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","support.type.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk10","bold":false,"italic":false,"underline":false,"meta":16941098,"color":"#4EC9B0"},"additionalThemeTokenData":[],"className":"mtk10","html":"<span class=\"mtk10\">tuple</span>"},{"text":")","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.parenthesis.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":51,"endIndex":52,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> </span><span class=\"mtk4\">not</span><span class=\"mtk1\"> </span><span class=\"mtk11\">isinstance</span><span class=\"mtk1\">(params[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">], (</span><span class=\"mtk10\">list</span><span class=\"mtk1\">, </span><span class=\"mtk10\">tuple</span><span class=\"mtk1\">)):</span></span></span>"},{"text":"            params = chunks(params, 2)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"params","startIndex":12,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":19,"endIndex":20,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chunks","startIndex":21,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">chunks</span>"},{"text":"(","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"params","startIndex":28,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":",","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"2","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":")","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            params = chunks(params, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">)</span></span></span>"},{"text":"        log_prob = prior_log_prob_fn(w_prior, b_prior, params)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"log_prob","startIndex":8,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":17,"endIndex":18,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"prior_log_prob_fn","startIndex":19,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">prior_log_prob_fn</span>"},{"text":"(","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"w_prior","startIndex":37,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w_prior</span>"},{"text":",","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b_prior","startIndex":46,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b_prior</span>"},{"text":",","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"params","startIndex":55,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":")","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        log_prob = prior_log_prob_fn(w_prior, b_prior, params)</span></span></span>"},{"text":"        log_prob += bnn_log_prob_fn(X_train, y_train, params)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"log_prob","startIndex":8,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+=","startIndex":17,"endIndex":19,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+=</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bnn_log_prob_fn","startIndex":20,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn_log_prob_fn</span>"},{"text":"(","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X_train","startIndex":36,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_train</span>"},{"text":",","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_train","startIndex":45,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_train</span>"},{"text":",","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"params","startIndex":54,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":")","startIndex":60,"endIndex":61,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        log_prob += bnn_log_prob_fn(X_train, y_train, params)</span></span></span>"},{"text":"        return log_prob","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"return","startIndex":8,"endIndex":14,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"log_prob","startIndex":15,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> log_prob</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    return target_log_prob_fn","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"target_log_prob_fn","startIndex":11,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">target_log_prob_fn</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> target_log_prob_fn</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def tracer_factory(X, y):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tracer_factory","startIndex":4,"endIndex":18,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">tracer_factory</span>"},{"text":"(","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X","startIndex":19,"endIndex":20,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">X</span>"},{"text":",","startIndex":20,"endIndex":21,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">y</span>"},{"text":")","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">tracer_factory</span><span class=\"mtk1\">(</span><span class=\"mtk12\">X</span><span class=\"mtk1\">, </span><span class=\"mtk12\">y</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    return lambda params: ft.partial(bnn_log_prob_fn, X, y, get_mean=True)(params)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"lambda","startIndex":11,"endIndex":17,"scopes":["source.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python","meta.lambda-function.python","meta.function.lambda.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"params","startIndex":18,"endIndex":24,"scopes":["source.python","meta.lambda-function.python","meta.function.lambda.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">params</span>"},{"text":":","startIndex":24,"endIndex":25,"scopes":["source.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"ft","startIndex":26,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">ft</span>"},{"text":".","startIndex":28,"endIndex":29,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"partial","startIndex":29,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">partial</span>"},{"text":"(","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"bnn_log_prob_fn","startIndex":37,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn_log_prob_fn</span>"},{"text":",","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"X","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X</span>"},{"text":",","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y</span>"},{"text":",","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_mean","startIndex":60,"endIndex":68,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">get_mean</span>"},{"text":"=","startIndex":68,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"True","startIndex":69,"endIndex":73,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">True</span>"},{"text":")","startIndex":73,"endIndex":74,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":"(","startIndex":74,"endIndex":75,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"params","startIndex":75,"endIndex":81,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">params</span>"},{"text":")","startIndex":81,"endIndex":82,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">lambda</span><span class=\"mtk1\"> </span><span class=\"mtk12\">params</span><span class=\"mtk1\">: ft.partial(bnn_log_prob_fn, X, y, </span><span class=\"mtk12\">get_mean</span><span class=\"mtk1\">=</span><span class=\"mtk4\">True</span><span class=\"mtk1\">)(params)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def chunks(lst, n):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"chunks","startIndex":4,"endIndex":10,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">chunks</span>"},{"text":"(","startIndex":10,"endIndex":11,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"lst","startIndex":11,"endIndex":14,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">lst</span>"},{"text":",","startIndex":14,"endIndex":15,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">n</span>"},{"text":")","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">chunks</span><span class=\"mtk1\">(</span><span class=\"mtk12\">lst</span><span class=\"mtk1\">, </span><span class=\"mtk12\">n</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    # Subdivide lst into successive n-sized chunks.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"#","startIndex":4,"endIndex":5,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" Subdivide lst into successive n-sized chunks.","startIndex":5,"endIndex":51,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> Subdivide lst into successive n-sized chunks.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Subdivide lst into successive n-sized chunks.</span></span></span>"},{"text":"    return [lst[i : i + n] for i in range(0, len(lst), n)]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":11,"endIndex":12,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"lst","startIndex":12,"endIndex":15,"scopes":["source.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">lst</span>"},{"text":"[","startIndex":15,"endIndex":16,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"i","startIndex":16,"endIndex":17,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">i</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":":","startIndex":18,"endIndex":19,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.slice.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"i","startIndex":20,"endIndex":21,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">i</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"+","startIndex":22,"endIndex":23,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">+</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n","startIndex":24,"endIndex":25,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n</span>"},{"text":"]","startIndex":25,"endIndex":26,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":27,"endIndex":30,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":30,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"i","startIndex":31,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">i</span>"},{"text":" ","startIndex":32,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":33,"endIndex":35,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"range","startIndex":36,"endIndex":41,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">range</span>"},{"text":"(","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"0","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":",","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"len","startIndex":45,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">len</span>"},{"text":"(","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"lst","startIndex":49,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">lst</span>"},{"text":")","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n</span>"},{"text":")","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":"]","startIndex":57,"endIndex":58,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> [lst[i : i + n] </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> i </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">range</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk11\">len</span><span class=\"mtk1\">(lst), n)]</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def get_random_initial_state(w_prior, b_prior, nodes_per_layer, overdisp=1.0):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_random_initial_state","startIndex":4,"endIndex":28,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">get_random_initial_state</span>"},{"text":"(","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"w_prior","startIndex":29,"endIndex":36,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">w_prior</span>"},{"text":",","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b_prior","startIndex":38,"endIndex":45,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">b_prior</span>"},{"text":",","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"nodes_per_layer","startIndex":47,"endIndex":62,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">nodes_per_layer</span>"},{"text":",","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"overdisp","startIndex":64,"endIndex":72,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">overdisp</span>"},{"text":"=","startIndex":72,"endIndex":73,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"1.0","startIndex":73,"endIndex":76,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1.0</span>"},{"text":")","startIndex":76,"endIndex":77,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":77,"endIndex":78,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">get_random_initial_state</span><span class=\"mtk1\">(</span><span class=\"mtk12\">w_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">b_prior</span><span class=\"mtk1\">, </span><span class=\"mtk12\">nodes_per_layer</span><span class=\"mtk1\">, </span><span class=\"mtk12\">overdisp</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1.0</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    \"\"\"Draw random samples for weights and biases of a NN according to some","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"},{"text":"Draw random samples for weights and biases of a NN according to some","startIndex":7,"endIndex":76,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">Draw random samples for weights and biases of a NN according to some</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&quot;&quot;&quot;Draw random samples for weights and biases of a NN according to some</span></span></span>"},{"text":"    specified priors. distributions. This set of parameter values can serve as a","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    specified priors. distributions. This set of parameter values can serve as a","startIndex":0,"endIndex":81,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    specified priors. distributions. This set of parameter values can serve as a</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    specified priors. distributions. This set of parameter values can serve as a</span></span></span>"},{"text":"    starting point for MCMC or gradient descent training.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    starting point for MCMC or gradient descent training.","startIndex":0,"endIndex":58,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    starting point for MCMC or gradient descent training.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    starting point for MCMC or gradient descent training.</span></span></span>"},{"text":"    \"\"\"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","string.quoted.docstring.multi.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">    </span>"},{"text":"\"\"\"","startIndex":4,"endIndex":7,"scopes":["source.python","string.quoted.docstring.multi.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;&quot;&quot;</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    &quot;&quot;&quot;</span></span></span>"},{"text":"    init_state = []","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"init_state","startIndex":4,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">init_state</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":15,"endIndex":16,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":17,"endIndex":18,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"]","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    init_state = []</span></span></span>"},{"text":"    for n1, n2 in zip(nodes_per_layer, nodes_per_layer[1:]):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"for","startIndex":4,"endIndex":7,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n1","startIndex":8,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n1</span>"},{"text":",","startIndex":10,"endIndex":11,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n2","startIndex":12,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n2</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":15,"endIndex":17,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"zip","startIndex":18,"endIndex":21,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">zip</span>"},{"text":"(","startIndex":21,"endIndex":22,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"nodes_per_layer","startIndex":22,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nodes_per_layer</span>"},{"text":",","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"nodes_per_layer","startIndex":39,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nodes_per_layer</span>"},{"text":"[","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"1","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":":","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","punctuation.separator.slice.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":"]","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":59,"endIndex":60,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> n1, n2 </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">zip</span><span class=\"mtk1\">(nodes_per_layer, nodes_per_layer[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">:]):</span></span></span>"},{"text":"        w_shape, b_shape = [n1, n2], n2","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"w_shape","startIndex":8,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w_shape</span>"},{"text":",","startIndex":15,"endIndex":16,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b_shape","startIndex":17,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b_shape</span>"},{"text":" ","startIndex":24,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":25,"endIndex":26,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":27,"endIndex":28,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"n1","startIndex":28,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n1</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":31,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n2","startIndex":32,"endIndex":34,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n2</span>"},{"text":"]","startIndex":34,"endIndex":35,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":",","startIndex":35,"endIndex":36,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":36,"endIndex":37,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n2","startIndex":37,"endIndex":39,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n2</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        w_shape, b_shape = [n1, n2], n2</span></span></span>"},{"text":"        # Use overdispersion > 1 for better R-hat statistics.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"#","startIndex":8,"endIndex":9,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" Use overdispersion > 1 for better R-hat statistics.","startIndex":9,"endIndex":61,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> Use overdispersion &gt; 1 for better R-hat statistics.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># Use overdispersion &gt; 1 for better R-hat statistics.</span></span></span>"},{"text":"        w = w_prior.sample(w_shape) * overdisp","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"w","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":10,"endIndex":11,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"w_prior","startIndex":12,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w_prior</span>"},{"text":".","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"sample","startIndex":20,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sample</span>"},{"text":"(","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"w_shape","startIndex":27,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w_shape</span>"},{"text":")","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"*","startIndex":36,"endIndex":37,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":" ","startIndex":37,"endIndex":38,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"overdisp","startIndex":38,"endIndex":46,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">overdisp</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        w = w_prior.sample(w_shape) * overdisp</span></span></span>"},{"text":"        b = b_prior.sample(b_shape) * overdisp","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"b","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":10,"endIndex":11,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"b_prior","startIndex":12,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b_prior</span>"},{"text":".","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"sample","startIndex":20,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">sample</span>"},{"text":"(","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"b_shape","startIndex":27,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b_shape</span>"},{"text":")","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"*","startIndex":36,"endIndex":37,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":" ","startIndex":37,"endIndex":38,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"overdisp","startIndex":38,"endIndex":46,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">overdisp</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        b = b_prior.sample(b_shape) * overdisp</span></span></span>"},{"text":"        init_state.append([tf.Variable(w), tf.Variable(b)])","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"init_state","startIndex":8,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">init_state</span>"},{"text":".","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"append","startIndex":19,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">append</span>"},{"text":"(","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"[","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"tf","startIndex":27,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Variable","startIndex":30,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Variable</span>"},{"text":"(","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"w","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">w</span>"},{"text":")","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":43,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Variable","startIndex":46,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Variable</span>"},{"text":"(","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"b","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">b</span>"},{"text":")","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":"]","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        init_state.append([tf.Variable(w), tf.Variable(b)])</span></span></span>"},{"text":"    return init_state","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"init_state","startIndex":11,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">init_state</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> init_state</span></span></span>"}],"id":"09dccba9-4524-57c8-8828-ac966794b9e3","parent":"c0e1786f-a24c-5cb8-8f6d-ac33c4b0dfed","internal":{"type":"GRVSCCodeBlock","contentDigest":"e69eb295cd61d25ab37edf533e9aed12","counter":1028,"owner":"gatsby-plugin-mdx"},"children":[]},{"index":4,"text":"import numpy as np\nimport tensorflow as tf\n\n\ndef get_map_trace(target_log_prob_fn, state, n_iter=1000, save_every=10, callbacks=[]):\n    optimizer = tf.optimizers.Adam()\n\n    @tf.function\n    def minimize():\n        optimizer.minimize(lambda: -target_log_prob_fn(*state), state)\n\n    state_trace, cb_trace = [], [[] for _ in callbacks]\n    for i in range(n_iter):\n        if i % save_every == 0:\n            state_trace.append(state)\n            for trace, cb in zip(cb_trace, callbacks):\n                trace.append(cb(state).numpy())\n        minimize()\n\n    return state_trace, cb_trace\n\n\ndef get_best_map_state(map_trace, map_log_probs):\n    # map_log_probs[0/1]: train/test log probability\n    test_set_max_log_prob_idx = np.argmax(map_log_probs[1])\n    # Return MAP params that achieved highest test set likelihood.\n    return map_trace[test_set_max_log_prob_idx]\n\n\ndef get_nodes_per_layer(n_features, net_taper=(1, 0.5, 0.2, 0.1)):\n    nodes_per_layer = [int(n_features * x) for x in net_taper]\n    # Ensure the last layer has two nodes so that output can be split into\n    # predictive mean and learned loss attenuation (see eq. (7) of\n    # https://arxiv.org/abs/1703.04977) which the network learns individually.\n    nodes_per_layer.append(2)\n    return nodes_per_layer","meta":{},"html":"<pre class=\"grvsc-container default-dark\" data-language=\"py\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> numpy </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> np</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">get_map_trace</span><span class=\"mtk1\">(</span><span class=\"mtk12\">target_log_prob_fn</span><span class=\"mtk1\">, </span><span class=\"mtk12\">state</span><span class=\"mtk1\">, </span><span class=\"mtk12\">n_iter</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1000</span><span class=\"mtk1\">, </span><span class=\"mtk12\">save_every</span><span class=\"mtk1\">=</span><span class=\"mtk7\">10</span><span class=\"mtk1\">, </span><span class=\"mtk12\">callbacks</span><span class=\"mtk1\">=[]):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    optimizer = tf.optimizers.Adam()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">@tf.function</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">minimize</span><span class=\"mtk1\">():</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        optimizer.minimize(</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\">: -target_log_prob_fn(*state), state)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    state_trace, cb_trace = [], [[] </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> _ </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> callbacks]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> i </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">range</span><span class=\"mtk1\">(n_iter):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> i % save_every == </span><span class=\"mtk7\">0</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            state_trace.append(state)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> trace, cb </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">zip</span><span class=\"mtk1\">(cb_trace, callbacks):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                trace.append(cb(state).numpy())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        minimize()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> state_trace, cb_trace</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">get_best_map_state</span><span class=\"mtk1\">(</span><span class=\"mtk12\">map_trace</span><span class=\"mtk1\">, </span><span class=\"mtk12\">map_log_probs</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># map_log_probs[0/1]: train/test log probability</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    test_set_max_log_prob_idx = np.argmax(map_log_probs[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Return MAP params that achieved highest test set likelihood.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> map_trace[test_set_max_log_prob_idx]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">get_nodes_per_layer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">n_features</span><span class=\"mtk1\">, </span><span class=\"mtk12\">net_taper</span><span class=\"mtk1\">=(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.5</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.2</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.1</span><span class=\"mtk1\">)):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    nodes_per_layer = [</span><span class=\"mtk10\">int</span><span class=\"mtk1\">(n_features * x) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> x </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> net_taper]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Ensure the last layer has two nodes so that output can be split into</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># predictive mean and learned loss attenuation (see eq. (7) of</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># https://arxiv.org/abs/1703.04977) which the network learns individually.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    nodes_per_layer.append(</span><span class=\"mtk7\">2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> nodes_per_layer</span></span></span></code></pre>","preClassName":"grvsc-container default-dark","codeClassName":"grvsc-code","language":"py","defaultTheme":{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]},"additionalThemes":[{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]}],"tokenizedLines":[{"text":"import numpy as np","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"numpy","startIndex":7,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">numpy</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":13,"endIndex":15,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"np","startIndex":16,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">np</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> numpy </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> np</span></span></span>"},{"text":"import tensorflow as tf","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow","startIndex":7,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":18,"endIndex":20,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":21,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def get_map_trace(target_log_prob_fn, state, n_iter=1000, save_every=10, callbacks=[]):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_map_trace","startIndex":4,"endIndex":17,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">get_map_trace</span>"},{"text":"(","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"target_log_prob_fn","startIndex":18,"endIndex":36,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">target_log_prob_fn</span>"},{"text":",","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"state","startIndex":38,"endIndex":43,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">state</span>"},{"text":",","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"n_iter","startIndex":45,"endIndex":51,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">n_iter</span>"},{"text":"=","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"1000","startIndex":52,"endIndex":56,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1000</span>"},{"text":",","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"save_every","startIndex":58,"endIndex":68,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">save_every</span>"},{"text":"=","startIndex":68,"endIndex":69,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"10","startIndex":69,"endIndex":71,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">10</span>"},{"text":",","startIndex":71,"endIndex":72,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":72,"endIndex":73,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"callbacks","startIndex":73,"endIndex":82,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">callbacks</span>"},{"text":"=","startIndex":82,"endIndex":83,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"[","startIndex":83,"endIndex":84,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"]","startIndex":84,"endIndex":85,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":85,"endIndex":86,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":86,"endIndex":87,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">get_map_trace</span><span class=\"mtk1\">(</span><span class=\"mtk12\">target_log_prob_fn</span><span class=\"mtk1\">, </span><span class=\"mtk12\">state</span><span class=\"mtk1\">, </span><span class=\"mtk12\">n_iter</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1000</span><span class=\"mtk1\">, </span><span class=\"mtk12\">save_every</span><span class=\"mtk1\">=</span><span class=\"mtk7\">10</span><span class=\"mtk1\">, </span><span class=\"mtk12\">callbacks</span><span class=\"mtk1\">=[]):</span></span></span>"},{"text":"    optimizer = tf.optimizers.Adam()","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"optimizer","startIndex":4,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">optimizer</span>"},{"text":" ","startIndex":13,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":14,"endIndex":15,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":16,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"optimizers","startIndex":19,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">optimizers</span>"},{"text":".","startIndex":29,"endIndex":30,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Adam","startIndex":30,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Adam</span>"},{"text":"(","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    optimizer = tf.optimizers.Adam()</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    @tf.function","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"@","startIndex":4,"endIndex":5,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python","punctuation.definition.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">@</span>"},{"text":"tf","startIndex":5,"endIndex":7,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">tf</span>"},{"text":".","startIndex":7,"endIndex":8,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">.</span>"},{"text":"function","startIndex":8,"endIndex":16,"scopes":["source.python","meta.function.decorator.python","entity.name.function.decorator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">function</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">@tf.function</span></span></span>"},{"text":"    def minimize():","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"def","startIndex":4,"endIndex":7,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"minimize","startIndex":8,"endIndex":16,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">minimize</span>"},{"text":"(","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">minimize</span><span class=\"mtk1\">():</span></span></span>"},{"text":"        optimizer.minimize(lambda: -target_log_prob_fn(*state), state)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"optimizer","startIndex":8,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">optimizer</span>"},{"text":".","startIndex":17,"endIndex":18,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"minimize","startIndex":18,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">minimize</span>"},{"text":"(","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"lambda","startIndex":27,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","storage.type.function.lambda.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">lambda</span>"},{"text":":","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.lambda-function.python","punctuation.section.function.lambda.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"},{"text":" ","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"-","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"target_log_prob_fn","startIndex":36,"endIndex":54,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">target_log_prob_fn</span>"},{"text":"(","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"*","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.unpacking.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"state","startIndex":56,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">state</span>"},{"text":")","startIndex":61,"endIndex":62,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":62,"endIndex":63,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"state","startIndex":64,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">state</span>"},{"text":")","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        optimizer.minimize(</span><span class=\"mtk4\">lambda</span><span class=\"mtk1\">: -target_log_prob_fn(*state), state)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    state_trace, cb_trace = [], [[] for _ in callbacks]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"state_trace","startIndex":4,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">state_trace</span>"},{"text":",","startIndex":15,"endIndex":16,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"cb_trace","startIndex":17,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">cb_trace</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":26,"endIndex":27,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":28,"endIndex":29,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"]","startIndex":29,"endIndex":30,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":31,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":32,"endIndex":33,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"[","startIndex":33,"endIndex":34,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"]","startIndex":34,"endIndex":35,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":36,"endIndex":39,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"_","startIndex":40,"endIndex":41,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">_</span>"},{"text":" ","startIndex":41,"endIndex":42,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":42,"endIndex":44,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":44,"endIndex":45,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"callbacks","startIndex":45,"endIndex":54,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">callbacks</span>"},{"text":"]","startIndex":54,"endIndex":55,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    state_trace, cb_trace = [], [[] </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> _ </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> callbacks]</span></span></span>"},{"text":"    for i in range(n_iter):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"for","startIndex":4,"endIndex":7,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":7,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"i","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">i</span>"},{"text":" ","startIndex":9,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":10,"endIndex":12,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"range","startIndex":13,"endIndex":18,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">range</span>"},{"text":"(","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"n_iter","startIndex":19,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n_iter</span>"},{"text":")","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":26,"endIndex":27,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> i </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">range</span><span class=\"mtk1\">(n_iter):</span></span></span>"},{"text":"        if i % save_every == 0:","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"if","startIndex":8,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">if</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"i","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">i</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"%","startIndex":13,"endIndex":14,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">%</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"save_every","startIndex":15,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">save_every</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"==","startIndex":26,"endIndex":28,"scopes":["source.python","keyword.operator.comparison.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">==</span>"},{"text":" ","startIndex":28,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0","startIndex":29,"endIndex":30,"scopes":["source.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":":","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> i % save_every == </span><span class=\"mtk7\">0</span><span class=\"mtk1\">:</span></span></span>"},{"text":"            state_trace.append(state)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"state_trace","startIndex":12,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">state_trace</span>"},{"text":".","startIndex":23,"endIndex":24,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"append","startIndex":24,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">append</span>"},{"text":"(","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"state","startIndex":31,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">state</span>"},{"text":")","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            state_trace.append(state)</span></span></span>"},{"text":"            for trace, cb in zip(cb_trace, callbacks):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"            ","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">            </span>"},{"text":"for","startIndex":12,"endIndex":15,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"trace","startIndex":16,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":",","startIndex":21,"endIndex":22,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"cb","startIndex":23,"endIndex":25,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">cb</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":26,"endIndex":28,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":28,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"zip","startIndex":29,"endIndex":32,"scopes":["source.python","meta.function-call.python","support.function.builtin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">zip</span>"},{"text":"(","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"cb_trace","startIndex":33,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">cb_trace</span>"},{"text":",","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"callbacks","startIndex":43,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">callbacks</span>"},{"text":")","startIndex":52,"endIndex":53,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":53,"endIndex":54,"scopes":["source.python","punctuation.separator.colon.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> trace, cb </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk11\">zip</span><span class=\"mtk1\">(cb_trace, callbacks):</span></span></span>"},{"text":"                trace.append(cb(state).numpy())","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"                ","startIndex":0,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">                </span>"},{"text":"trace","startIndex":16,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":".","startIndex":21,"endIndex":22,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"append","startIndex":22,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">append</span>"},{"text":"(","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"cb","startIndex":29,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">cb</span>"},{"text":"(","startIndex":31,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"state","startIndex":32,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">state</span>"},{"text":")","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":".","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"numpy","startIndex":39,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">numpy</span>"},{"text":"(","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                trace.append(cb(state).numpy())</span></span></span>"},{"text":"        minimize()","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"        ","startIndex":0,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">        </span>"},{"text":"minimize","startIndex":8,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">minimize</span>"},{"text":"(","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        minimize()</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"    return state_trace, cb_trace","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"state_trace","startIndex":11,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">state_trace</span>"},{"text":",","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"cb_trace","startIndex":24,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">cb_trace</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> state_trace, cb_trace</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def get_best_map_state(map_trace, map_log_probs):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_best_map_state","startIndex":4,"endIndex":22,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">get_best_map_state</span>"},{"text":"(","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"map_trace","startIndex":23,"endIndex":32,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">map_trace</span>"},{"text":",","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"map_log_probs","startIndex":34,"endIndex":47,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">map_log_probs</span>"},{"text":")","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">get_best_map_state</span><span class=\"mtk1\">(</span><span class=\"mtk12\">map_trace</span><span class=\"mtk1\">, </span><span class=\"mtk12\">map_log_probs</span><span class=\"mtk1\">):</span></span></span>"},{"text":"    # map_log_probs[0/1]: train/test log probability","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"#","startIndex":4,"endIndex":5,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" map_log_probs[0/1]: train/test log probability","startIndex":5,"endIndex":52,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> map_log_probs[0/1]: train/test log probability</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># map_log_probs[0/1]: train/test log probability</span></span></span>"},{"text":"    test_set_max_log_prob_idx = np.argmax(map_log_probs[1])","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"test_set_max_log_prob_idx","startIndex":4,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">test_set_max_log_prob_idx</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":30,"endIndex":31,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":31,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"np","startIndex":32,"endIndex":34,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">np</span>"},{"text":".","startIndex":34,"endIndex":35,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"argmax","startIndex":35,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">argmax</span>"},{"text":"(","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"map_log_probs","startIndex":42,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map_log_probs</span>"},{"text":"[","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"1","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":"]","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":")","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    test_set_max_log_prob_idx = np.argmax(map_log_probs[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">])</span></span></span>"},{"text":"    # Return MAP params that achieved highest test set likelihood.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"#","startIndex":4,"endIndex":5,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" Return MAP params that achieved highest test set likelihood.","startIndex":5,"endIndex":66,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> Return MAP params that achieved highest test set likelihood.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Return MAP params that achieved highest test set likelihood.</span></span></span>"},{"text":"    return map_trace[test_set_max_log_prob_idx]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"map_trace","startIndex":11,"endIndex":20,"scopes":["source.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map_trace</span>"},{"text":"[","startIndex":20,"endIndex":21,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"test_set_max_log_prob_idx","startIndex":21,"endIndex":46,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">test_set_max_log_prob_idx</span>"},{"text":"]","startIndex":46,"endIndex":47,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> map_trace[test_set_max_log_prob_idx]</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"def get_nodes_per_layer(n_features, net_taper=(1, 0.5, 0.2, 0.1)):","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"def","startIndex":0,"endIndex":3,"scopes":["source.python","meta.function.python","storage.type.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">def</span>"},{"text":" ","startIndex":3,"endIndex":4,"scopes":["source.python","meta.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_nodes_per_layer","startIndex":4,"endIndex":23,"scopes":["source.python","meta.function.python","entity.name.function.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk11","bold":false,"italic":false,"underline":false,"meta":16957482,"color":"#DCDCAA"},"additionalThemeTokenData":[],"className":"mtk11","html":"<span class=\"mtk11\">get_nodes_per_layer</span>"},{"text":"(","startIndex":23,"endIndex":24,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"n_features","startIndex":24,"endIndex":34,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">n_features</span>"},{"text":",","startIndex":34,"endIndex":35,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"net_taper","startIndex":36,"endIndex":45,"scopes":["source.python","meta.function.python","meta.function.parameters.python","variable.parameter.function.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">net_taper</span>"},{"text":"=","startIndex":45,"endIndex":46,"scopes":["source.python","meta.function.python","meta.function.parameters.python","keyword.operator.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"(","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.parenthesis.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"1","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":",","startIndex":48,"endIndex":49,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0.5","startIndex":50,"endIndex":53,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.5</span>"},{"text":",","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0.2","startIndex":55,"endIndex":58,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.2</span>"},{"text":",","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":59,"endIndex":60,"scopes":["source.python","meta.function.python","meta.function.parameters.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0.1","startIndex":60,"endIndex":63,"scopes":["source.python","meta.function.python","meta.function.parameters.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.1</span>"},{"text":")","startIndex":63,"endIndex":64,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.parenthesis.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":")","startIndex":64,"endIndex":65,"scopes":["source.python","meta.function.python","meta.function.parameters.python","punctuation.definition.parameters.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":":","startIndex":65,"endIndex":66,"scopes":["source.python","meta.function.python","punctuation.section.function.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">:</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">get_nodes_per_layer</span><span class=\"mtk1\">(</span><span class=\"mtk12\">n_features</span><span class=\"mtk1\">, </span><span class=\"mtk12\">net_taper</span><span class=\"mtk1\">=(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.5</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.2</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.1</span><span class=\"mtk1\">)):</span></span></span>"},{"text":"    nodes_per_layer = [int(n_features * x) for x in net_taper]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"nodes_per_layer","startIndex":4,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nodes_per_layer</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":20,"endIndex":21,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"int","startIndex":23,"endIndex":26,"scopes":["source.python","meta.function-call.python","support.type.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk10","bold":false,"italic":false,"underline":false,"meta":16941098,"color":"#4EC9B0"},"additionalThemeTokenData":[],"className":"mtk10","html":"<span class=\"mtk10\">int</span>"},{"text":"(","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"n_features","startIndex":27,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n_features</span>"},{"text":" ","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"*","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"x","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">x</span>"},{"text":")","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":42,"endIndex":43,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":43,"endIndex":46,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":46,"endIndex":47,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"x","startIndex":47,"endIndex":48,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">x</span>"},{"text":" ","startIndex":48,"endIndex":49,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":49,"endIndex":51,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":51,"endIndex":52,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"net_taper","startIndex":52,"endIndex":61,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">net_taper</span>"},{"text":"]","startIndex":61,"endIndex":62,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    nodes_per_layer = [</span><span class=\"mtk10\">int</span><span class=\"mtk1\">(n_features * x) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> x </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> net_taper]</span></span></span>"},{"text":"    # Ensure the last layer has two nodes so that output can be split into","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"#","startIndex":4,"endIndex":5,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" Ensure the last layer has two nodes so that output can be split into","startIndex":5,"endIndex":74,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> Ensure the last layer has two nodes so that output can be split into</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Ensure the last layer has two nodes so that output can be split into</span></span></span>"},{"text":"    # predictive mean and learned loss attenuation (see eq. (7) of","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"#","startIndex":4,"endIndex":5,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" predictive mean and learned loss attenuation (see eq. (7) of","startIndex":5,"endIndex":66,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> predictive mean and learned loss attenuation (see eq. (7) of</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># predictive mean and learned loss attenuation (see eq. (7) of</span></span></span>"},{"text":"    # https://arxiv.org/abs/1703.04977) which the network learns individually.","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"#","startIndex":4,"endIndex":5,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" https://arxiv.org/abs/1703.04977) which the network learns individually.","startIndex":5,"endIndex":78,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> https://arxiv.org/abs/1703.04977) which the network learns individually.</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># https://arxiv.org/abs/1703.04977) which the network learns individually.</span></span></span>"},{"text":"    nodes_per_layer.append(2)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"nodes_per_layer","startIndex":4,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nodes_per_layer</span>"},{"text":".","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"append","startIndex":20,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">append</span>"},{"text":"(","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"2","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">2</span>"},{"text":")","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    nodes_per_layer.append(</span><span class=\"mtk7\">2</span><span class=\"mtk1\">)</span></span></span>"},{"text":"    return nodes_per_layer","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"return","startIndex":4,"endIndex":10,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">return</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"nodes_per_layer","startIndex":11,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">nodes_per_layer</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> nodes_per_layer</span></span></span>"}],"id":"be6d28c2-168d-51d6-8695-b6b7603f8909","parent":"c0e1786f-a24c-5cb8-8f6d-ac33c4b0dfed","internal":{"type":"GRVSCCodeBlock","contentDigest":"74bd29360d646b217d91570be507e7ec","counter":1029,"owner":"gatsby-plugin-mdx"},"children":[]},{"index":5,"text":"# %%\nimport tensorflow as tf\nimport tensorflow_probability as tfp\n\nfrom bnn import (\n    get_random_initial_state,\n    target_log_prob_fn_factory,\n    tracer_factory,\n)\nfrom bnn.hmc import predict_from_chain, run_hmc\nfrom bnn.map import get_best_map_state, get_map_trace, get_nodes_per_layer\n\n# %%\n# About the data: https://kaggle.com/c/boston-housing\ntrain, test = tf.keras.datasets.boston_housing.load_data()\nX_train, y_train, X_test, y_test = [arr.astype(\"float32\") for arr in [*train, *test]]\n\n\n# %%\nweight_prior = tfp.distributions.Normal(0, 0.2)\nbias_prior = tfp.distributions.Normal(0, 0.2)\n\n\n# %%\nlog_prob_tracers = (\n    tracer_factory(X_train, y_train),\n    tracer_factory(X_test, y_test),\n)\n\nn_features = X_train.shape[-1]\nrandom_initial_state = get_random_initial_state(\n    weight_prior, bias_prior, get_nodes_per_layer(n_features)\n)\n\ntrace, log_probs = get_map_trace(\n    target_log_prob_fn_factory(weight_prior, bias_prior, X_train, y_train),\n    random_initial_state,\n    n_iter=3000,\n    callbacks=log_prob_tracers,\n)\nbest_map_params = get_best_map_state(trace, log_probs)\n\n\n# %%\nmap_nn = bnn.build_net(best_map_params)\nmap_y_pred, map_y_var = map_nn(X_test, training=False)\n\n\n# %%\nbnn_log_prob_fn = target_log_prob_fn_factory(weight_prior, bias_prior, X_train, y_train)\n_, samples, _, _ = run_hmc(bnn_log_prob_fn, current_state=best_map_params)\nhmc_y_pred, hmc_y_var = predict_from_chain(samples, X_test)","meta":{},"html":"<pre class=\"grvsc-container default-dark\" data-language=\"py\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow_probability </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tfp</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> bnn </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    get_random_initial_state,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    target_log_prob_fn_factory,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tracer_factory,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> bnn.hmc </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> predict_from_chain, run_hmc</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> bnn.map </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> get_best_map_state, get_map_trace, get_nodes_per_layer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># About the data: https://kaggle.com/c/boston-housing</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">train, test = tf.keras.datasets.boston_housing.load_data()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">X_train, y_train, X_test, y_test = [arr.astype(</span><span class=\"mtk8\">&quot;float32&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> arr </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> [*train, *test]]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">weight_prior = tfp.distributions.Normal(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bias_prior = tfp.distributions.Normal(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">log_prob_tracers = (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tracer_factory(X_train, y_train),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tracer_factory(X_test, y_test),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">n_features = X_train.shape[-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">random_initial_state = get_random_initial_state(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    weight_prior, bias_prior, get_nodes_per_layer(n_features)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">trace, log_probs = get_map_trace(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    target_log_prob_fn_factory(weight_prior, bias_prior, X_train, y_train),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    random_initial_state,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">n_iter</span><span class=\"mtk1\">=</span><span class=\"mtk7\">3000</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">callbacks</span><span class=\"mtk1\">=log_prob_tracers,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">best_map_params = get_best_map_state(trace, log_probs)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">map_nn = bnn.build_net(best_map_params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">map_y_pred, map_y_var = map_nn(X_test, </span><span class=\"mtk12\">training</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bnn_log_prob_fn = target_log_prob_fn_factory(weight_prior, bias_prior, X_train, y_train)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">_, samples, _, _ = run_hmc(bnn_log_prob_fn, </span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">=best_map_params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">hmc_y_pred, hmc_y_var = predict_from_chain(samples, X_test)</span></span></span></code></pre>","preClassName":"grvsc-container default-dark","codeClassName":"grvsc-code","language":"py","defaultTheme":{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]},"additionalThemes":[{"identifier":"Default Dark+","path":"/workspace/BGOONZ-BLOG-3.0/node_modules/gatsby-remark-vscode/lib/themes/dark_plus.json","conditions":[{"condition":"default"}]}],"tokenizedLines":[{"text":"# %%","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"#","startIndex":0,"endIndex":1,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" %%","startIndex":1,"endIndex":4,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> %%</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>"},{"text":"import tensorflow as tf","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow","startIndex":7,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":18,"endIndex":20,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":21,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tf</span></span></span>"},{"text":"import tensorflow_probability as tfp","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"import","startIndex":0,"endIndex":6,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tensorflow_probability","startIndex":7,"endIndex":29,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tensorflow_probability</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"as","startIndex":30,"endIndex":32,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">as</span>"},{"text":" ","startIndex":32,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":33,"endIndex":36,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> tensorflow_probability </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> tfp</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"from bnn import (","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"from","startIndex":0,"endIndex":4,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">from</span>"},{"text":" ","startIndex":4,"endIndex":5,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bnn","startIndex":5,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"import","startIndex":9,"endIndex":15,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"(","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.parenthesis.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> bnn </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> (</span></span></span>"},{"text":"    get_random_initial_state,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"get_random_initial_state","startIndex":4,"endIndex":28,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_random_initial_state</span>"},{"text":",","startIndex":28,"endIndex":29,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    get_random_initial_state,</span></span></span>"},{"text":"    target_log_prob_fn_factory,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"target_log_prob_fn_factory","startIndex":4,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">target_log_prob_fn_factory</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    target_log_prob_fn_factory,</span></span></span>"},{"text":"    tracer_factory,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"tracer_factory","startIndex":4,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tracer_factory</span>"},{"text":",","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tracer_factory,</span></span></span>"},{"text":")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","punctuation.parenthesis.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>"},{"text":"from bnn.hmc import predict_from_chain, run_hmc","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"from","startIndex":0,"endIndex":4,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">from</span>"},{"text":" ","startIndex":4,"endIndex":5,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bnn","startIndex":5,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn</span>"},{"text":".","startIndex":8,"endIndex":9,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"hmc","startIndex":9,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">hmc</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"import","startIndex":13,"endIndex":19,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"predict_from_chain","startIndex":20,"endIndex":38,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">predict_from_chain</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"run_hmc","startIndex":40,"endIndex":47,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">run_hmc</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> bnn.hmc </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> predict_from_chain, run_hmc</span></span></span>"},{"text":"from bnn.map import get_best_map_state, get_map_trace, get_nodes_per_layer","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"from","startIndex":0,"endIndex":4,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">from</span>"},{"text":" ","startIndex":4,"endIndex":5,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bnn","startIndex":5,"endIndex":8,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn</span>"},{"text":".","startIndex":8,"endIndex":9,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"map","startIndex":9,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"import","startIndex":13,"endIndex":19,"scopes":["source.python","keyword.control.import.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">import</span>"},{"text":" ","startIndex":19,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_best_map_state","startIndex":20,"endIndex":38,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_best_map_state</span>"},{"text":",","startIndex":38,"endIndex":39,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":39,"endIndex":40,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_map_trace","startIndex":40,"endIndex":53,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_map_trace</span>"},{"text":",","startIndex":53,"endIndex":54,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":54,"endIndex":55,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_nodes_per_layer","startIndex":55,"endIndex":74,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_nodes_per_layer</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> bnn.map </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> get_best_map_state, get_map_trace, get_nodes_per_layer</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"# %%","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"#","startIndex":0,"endIndex":1,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" %%","startIndex":1,"endIndex":4,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> %%</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>"},{"text":"# About the data: https://kaggle.com/c/boston-housing","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"#","startIndex":0,"endIndex":1,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" About the data: https://kaggle.com/c/boston-housing","startIndex":1,"endIndex":53,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> About the data: https://kaggle.com/c/boston-housing</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># About the data: https://kaggle.com/c/boston-housing</span></span></span>"},{"text":"train, test = tf.keras.datasets.boston_housing.load_data()","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"train","startIndex":0,"endIndex":5,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">train</span>"},{"text":",","startIndex":5,"endIndex":6,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"test","startIndex":7,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">test</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":12,"endIndex":13,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":13,"endIndex":14,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tf","startIndex":14,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tf</span>"},{"text":".","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"keras","startIndex":17,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">keras</span>"},{"text":".","startIndex":22,"endIndex":23,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"datasets","startIndex":23,"endIndex":31,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">datasets</span>"},{"text":".","startIndex":31,"endIndex":32,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"boston_housing","startIndex":32,"endIndex":46,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">boston_housing</span>"},{"text":".","startIndex":46,"endIndex":47,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"load_data","startIndex":47,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">load_data</span>"},{"text":"(","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":")","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">train, test = tf.keras.datasets.boston_housing.load_data()</span></span></span>"},{"text":"X_train, y_train, X_test, y_test = [arr.astype(\"float32\") for arr in [*train, *test]]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"X_train","startIndex":0,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_train</span>"},{"text":",","startIndex":7,"endIndex":8,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_train","startIndex":9,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_train</span>"},{"text":",","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"X_test","startIndex":18,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_test</span>"},{"text":",","startIndex":24,"endIndex":25,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":25,"endIndex":26,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_test","startIndex":26,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_test</span>"},{"text":" ","startIndex":32,"endIndex":33,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":33,"endIndex":34,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":34,"endIndex":35,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":35,"endIndex":36,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"arr","startIndex":36,"endIndex":39,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">arr</span>"},{"text":".","startIndex":39,"endIndex":40,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"astype","startIndex":40,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">astype</span>"},{"text":"(","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"\"","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":"float32","startIndex":48,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">float32</span>"},{"text":"\"","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","string.quoted.single.python","punctuation.definition.string.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk8","bold":false,"italic":false,"underline":false,"meta":16908842,"color":"#CE9178"},"additionalThemeTokenData":[],"className":"mtk8","html":"<span class=\"mtk8\">&quot;</span>"},{"text":")","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":" ","startIndex":57,"endIndex":58,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"for","startIndex":58,"endIndex":61,"scopes":["source.python","keyword.control.flow.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk15","bold":false,"italic":false,"underline":false,"meta":17023018,"color":"#C586C0"},"additionalThemeTokenData":[],"className":"mtk15","html":"<span class=\"mtk15\">for</span>"},{"text":" ","startIndex":61,"endIndex":62,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"arr","startIndex":62,"endIndex":65,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">arr</span>"},{"text":" ","startIndex":65,"endIndex":66,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"in","startIndex":66,"endIndex":68,"scopes":["source.python","keyword.operator.logical.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">in</span>"},{"text":" ","startIndex":68,"endIndex":69,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"[","startIndex":69,"endIndex":70,"scopes":["source.python","punctuation.definition.list.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"*","startIndex":70,"endIndex":71,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"train","startIndex":71,"endIndex":76,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">train</span>"},{"text":",","startIndex":76,"endIndex":77,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":77,"endIndex":78,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"*","startIndex":78,"endIndex":79,"scopes":["source.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">*</span>"},{"text":"test","startIndex":79,"endIndex":83,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">test</span>"},{"text":"]","startIndex":83,"endIndex":84,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"},{"text":"]","startIndex":84,"endIndex":85,"scopes":["source.python","punctuation.definition.list.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">X_train, y_train, X_test, y_test = [arr.astype(</span><span class=\"mtk8\">&quot;float32&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> arr </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> [*train, *test]]</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"# %%","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"#","startIndex":0,"endIndex":1,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" %%","startIndex":1,"endIndex":4,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> %%</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>"},{"text":"weight_prior = tfp.distributions.Normal(0, 0.2)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"weight_prior","startIndex":0,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">weight_prior</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":13,"endIndex":14,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":15,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":18,"endIndex":19,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"distributions","startIndex":19,"endIndex":32,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">distributions</span>"},{"text":".","startIndex":32,"endIndex":33,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Normal","startIndex":33,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Normal</span>"},{"text":"(","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"0","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":",","startIndex":41,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0.2","startIndex":43,"endIndex":46,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.2</span>"},{"text":")","startIndex":46,"endIndex":47,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">weight_prior = tfp.distributions.Normal(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.2</span><span class=\"mtk1\">)</span></span></span>"},{"text":"bias_prior = tfp.distributions.Normal(0, 0.2)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"bias_prior","startIndex":0,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bias_prior</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":11,"endIndex":12,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"tfp","startIndex":13,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tfp</span>"},{"text":".","startIndex":16,"endIndex":17,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"distributions","startIndex":17,"endIndex":30,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">distributions</span>"},{"text":".","startIndex":30,"endIndex":31,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"Normal","startIndex":31,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">Normal</span>"},{"text":"(","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"0","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0</span>"},{"text":",","startIndex":39,"endIndex":40,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":40,"endIndex":41,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"0.2","startIndex":41,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.float.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">0.2</span>"},{"text":")","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bias_prior = tfp.distributions.Normal(</span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.2</span><span class=\"mtk1\">)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"# %%","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"#","startIndex":0,"endIndex":1,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" %%","startIndex":1,"endIndex":4,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> %%</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>"},{"text":"log_prob_tracers = (","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"log_prob_tracers","startIndex":0,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob_tracers</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":17,"endIndex":18,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"(","startIndex":19,"endIndex":20,"scopes":["source.python","punctuation.parenthesis.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">log_prob_tracers = (</span></span></span>"},{"text":"    tracer_factory(X_train, y_train),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"tracer_factory","startIndex":4,"endIndex":18,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tracer_factory</span>"},{"text":"(","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X_train","startIndex":19,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_train</span>"},{"text":",","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":27,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_train","startIndex":28,"endIndex":35,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_train</span>"},{"text":")","startIndex":35,"endIndex":36,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":36,"endIndex":37,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tracer_factory(X_train, y_train),</span></span></span>"},{"text":"    tracer_factory(X_test, y_test),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"tracer_factory","startIndex":4,"endIndex":18,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">tracer_factory</span>"},{"text":"(","startIndex":18,"endIndex":19,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X_test","startIndex":19,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_test</span>"},{"text":",","startIndex":25,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_test","startIndex":27,"endIndex":33,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_test</span>"},{"text":")","startIndex":33,"endIndex":34,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":34,"endIndex":35,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tracer_factory(X_test, y_test),</span></span></span>"},{"text":")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","punctuation.parenthesis.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"n_features = X_train.shape[-1]","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"n_features","startIndex":0,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n_features</span>"},{"text":" ","startIndex":10,"endIndex":11,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":11,"endIndex":12,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"X_train","startIndex":13,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_train</span>"},{"text":".","startIndex":20,"endIndex":21,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"shape","startIndex":21,"endIndex":26,"scopes":["source.python","meta.item-access.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">shape</span>"},{"text":"[","startIndex":26,"endIndex":27,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">[</span>"},{"text":"-","startIndex":27,"endIndex":28,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","keyword.operator.arithmetic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">-</span>"},{"text":"1","startIndex":28,"endIndex":29,"scopes":["source.python","meta.item-access.python","meta.item-access.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">1</span>"},{"text":"]","startIndex":29,"endIndex":30,"scopes":["source.python","meta.item-access.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">]</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">n_features = X_train.shape[-</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]</span></span></span>"},{"text":"random_initial_state = get_random_initial_state(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"random_initial_state","startIndex":0,"endIndex":20,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">random_initial_state</span>"},{"text":" ","startIndex":20,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":21,"endIndex":22,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":22,"endIndex":23,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_random_initial_state","startIndex":23,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_random_initial_state</span>"},{"text":"(","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">random_initial_state = get_random_initial_state(</span></span></span>"},{"text":"    weight_prior, bias_prior, get_nodes_per_layer(n_features)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"weight_prior","startIndex":4,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">weight_prior</span>"},{"text":",","startIndex":16,"endIndex":17,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bias_prior","startIndex":18,"endIndex":28,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bias_prior</span>"},{"text":",","startIndex":28,"endIndex":29,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":29,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_nodes_per_layer","startIndex":30,"endIndex":49,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_nodes_per_layer</span>"},{"text":"(","startIndex":49,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"n_features","startIndex":50,"endIndex":60,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">n_features</span>"},{"text":")","startIndex":60,"endIndex":61,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    weight_prior, bias_prior, get_nodes_per_layer(n_features)</span></span></span>"},{"text":")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"trace, log_probs = get_map_trace(","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"trace","startIndex":0,"endIndex":5,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":",","startIndex":5,"endIndex":6,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"log_probs","startIndex":7,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_probs</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":17,"endIndex":18,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_map_trace","startIndex":19,"endIndex":32,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_map_trace</span>"},{"text":"(","startIndex":32,"endIndex":33,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">trace, log_probs = get_map_trace(</span></span></span>"},{"text":"    target_log_prob_fn_factory(weight_prior, bias_prior, X_train, y_train),","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"target_log_prob_fn_factory","startIndex":4,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">target_log_prob_fn_factory</span>"},{"text":"(","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"weight_prior","startIndex":31,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">weight_prior</span>"},{"text":",","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bias_prior","startIndex":45,"endIndex":55,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bias_prior</span>"},{"text":",","startIndex":55,"endIndex":56,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":56,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"X_train","startIndex":57,"endIndex":64,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_train</span>"},{"text":",","startIndex":64,"endIndex":65,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":65,"endIndex":66,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_train","startIndex":66,"endIndex":73,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_train</span>"},{"text":")","startIndex":73,"endIndex":74,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"},{"text":",","startIndex":74,"endIndex":75,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    target_log_prob_fn_factory(weight_prior, bias_prior, X_train, y_train),</span></span></span>"},{"text":"    random_initial_state,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"random_initial_state","startIndex":4,"endIndex":24,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">random_initial_state</span>"},{"text":",","startIndex":24,"endIndex":25,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    random_initial_state,</span></span></span>"},{"text":"    n_iter=3000,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"n_iter","startIndex":4,"endIndex":10,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">n_iter</span>"},{"text":"=","startIndex":10,"endIndex":11,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"3000","startIndex":11,"endIndex":15,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.numeric.dec.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk7","bold":false,"italic":false,"underline":false,"meta":16891946,"color":"#B5CEA8"},"additionalThemeTokenData":[],"className":"mtk7","html":"<span class=\"mtk7\">3000</span>"},{"text":",","startIndex":15,"endIndex":16,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">n_iter</span><span class=\"mtk1\">=</span><span class=\"mtk7\">3000</span><span class=\"mtk1\">,</span></span></span>"},{"text":"    callbacks=log_prob_tracers,","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"    ","startIndex":0,"endIndex":4,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">    </span>"},{"text":"callbacks","startIndex":4,"endIndex":13,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">callbacks</span>"},{"text":"=","startIndex":13,"endIndex":14,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"log_prob_tracers","startIndex":14,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_prob_tracers</span>"},{"text":",","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">callbacks</span><span class=\"mtk1\">=log_prob_tracers,</span></span></span>"},{"text":")","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":")","startIndex":0,"endIndex":1,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>"},{"text":"best_map_params = get_best_map_state(trace, log_probs)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"best_map_params","startIndex":0,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">best_map_params</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":16,"endIndex":17,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"get_best_map_state","startIndex":18,"endIndex":36,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">get_best_map_state</span>"},{"text":"(","startIndex":36,"endIndex":37,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"trace","startIndex":37,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">trace</span>"},{"text":",","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"log_probs","startIndex":44,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">log_probs</span>"},{"text":")","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">best_map_params = get_best_map_state(trace, log_probs)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"# %%","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"#","startIndex":0,"endIndex":1,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" %%","startIndex":1,"endIndex":4,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> %%</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>"},{"text":"map_nn = bnn.build_net(best_map_params)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"map_nn","startIndex":0,"endIndex":6,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map_nn</span>"},{"text":" ","startIndex":6,"endIndex":7,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":7,"endIndex":8,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":8,"endIndex":9,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bnn","startIndex":9,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn</span>"},{"text":".","startIndex":12,"endIndex":13,"scopes":["source.python","punctuation.separator.period.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">.</span>"},{"text":"build_net","startIndex":13,"endIndex":22,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">build_net</span>"},{"text":"(","startIndex":22,"endIndex":23,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"best_map_params","startIndex":23,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">best_map_params</span>"},{"text":")","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">map_nn = bnn.build_net(best_map_params)</span></span></span>"},{"text":"map_y_pred, map_y_var = map_nn(X_test, training=False)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"map_y_pred","startIndex":0,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map_y_pred</span>"},{"text":",","startIndex":10,"endIndex":11,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"map_y_var","startIndex":12,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map_y_var</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":22,"endIndex":23,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"map_nn","startIndex":24,"endIndex":30,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">map_nn</span>"},{"text":"(","startIndex":30,"endIndex":31,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"X_test","startIndex":31,"endIndex":37,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_test</span>"},{"text":",","startIndex":37,"endIndex":38,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":38,"endIndex":39,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"training","startIndex":39,"endIndex":47,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">training</span>"},{"text":"=","startIndex":47,"endIndex":48,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"False","startIndex":48,"endIndex":53,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","constant.language.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk4","bold":false,"italic":false,"underline":false,"meta":16842794,"color":"#569CD6"},"additionalThemeTokenData":[],"className":"mtk4","html":"<span class=\"mtk4\">False</span>"},{"text":")","startIndex":53,"endIndex":54,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">map_y_pred, map_y_var = map_nn(X_test, </span><span class=\"mtk12\">training</span><span class=\"mtk1\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>"},{"text":"# %%","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"#","startIndex":0,"endIndex":1,"scopes":["source.python","comment.line.number-sign.python","punctuation.definition.comment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\">#</span>"},{"text":" %%","startIndex":1,"endIndex":4,"scopes":["source.python","comment.line.number-sign.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk3","bold":false,"italic":false,"underline":false,"meta":16826666,"color":"#6A9955"},"additionalThemeTokenData":[],"className":"mtk3","html":"<span class=\"mtk3\"> %%</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># %%</span></span></span>"},{"text":"bnn_log_prob_fn = target_log_prob_fn_factory(weight_prior, bias_prior, X_train, y_train)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"bnn_log_prob_fn","startIndex":0,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn_log_prob_fn</span>"},{"text":" ","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":16,"endIndex":17,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":17,"endIndex":18,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"target_log_prob_fn_factory","startIndex":18,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">target_log_prob_fn_factory</span>"},{"text":"(","startIndex":44,"endIndex":45,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"weight_prior","startIndex":45,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">weight_prior</span>"},{"text":",","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"bias_prior","startIndex":59,"endIndex":69,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bias_prior</span>"},{"text":",","startIndex":69,"endIndex":70,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":70,"endIndex":71,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"X_train","startIndex":71,"endIndex":78,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_train</span>"},{"text":",","startIndex":78,"endIndex":79,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":79,"endIndex":80,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"y_train","startIndex":80,"endIndex":87,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">y_train</span>"},{"text":")","startIndex":87,"endIndex":88,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bnn_log_prob_fn = target_log_prob_fn_factory(weight_prior, bias_prior, X_train, y_train)</span></span></span>"},{"text":"_, samples, _, _ = run_hmc(bnn_log_prob_fn, current_state=best_map_params)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"_","startIndex":0,"endIndex":1,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">_</span>"},{"text":",","startIndex":1,"endIndex":2,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":2,"endIndex":3,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"samples","startIndex":3,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">samples</span>"},{"text":",","startIndex":10,"endIndex":11,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"_","startIndex":12,"endIndex":13,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">_</span>"},{"text":",","startIndex":13,"endIndex":14,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":14,"endIndex":15,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"_","startIndex":15,"endIndex":16,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">_</span>"},{"text":" ","startIndex":16,"endIndex":17,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":17,"endIndex":18,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":18,"endIndex":19,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"run_hmc","startIndex":19,"endIndex":26,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">run_hmc</span>"},{"text":"(","startIndex":26,"endIndex":27,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"bnn_log_prob_fn","startIndex":27,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">bnn_log_prob_fn</span>"},{"text":",","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":43,"endIndex":44,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"current_state","startIndex":44,"endIndex":57,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","variable.parameter.function-call.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk12","bold":false,"italic":false,"underline":false,"meta":16973866,"color":"#9CDCFE"},"additionalThemeTokenData":[],"className":"mtk12","html":"<span class=\"mtk12\">current_state</span>"},{"text":"=","startIndex":57,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":"best_map_params","startIndex":58,"endIndex":73,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">best_map_params</span>"},{"text":")","startIndex":73,"endIndex":74,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">_, samples, _, _ = run_hmc(bnn_log_prob_fn, </span><span class=\"mtk12\">current_state</span><span class=\"mtk1\">=best_map_params)</span></span></span>"},{"text":"hmc_y_pred, hmc_y_var = predict_from_chain(samples, X_test)","attrs":{},"data":{},"gutterCells":[],"className":"grvsc-line","tokens":[{"text":"hmc_y_pred","startIndex":0,"endIndex":10,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">hmc_y_pred</span>"},{"text":",","startIndex":10,"endIndex":11,"scopes":["source.python","punctuation.separator.element.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":11,"endIndex":12,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"hmc_y_var","startIndex":12,"endIndex":21,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">hmc_y_var</span>"},{"text":" ","startIndex":21,"endIndex":22,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"=","startIndex":22,"endIndex":23,"scopes":["source.python","keyword.operator.assignment.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">=</span>"},{"text":" ","startIndex":23,"endIndex":24,"scopes":["source.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"predict_from_chain","startIndex":24,"endIndex":42,"scopes":["source.python","meta.function-call.python","meta.function-call.generic.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">predict_from_chain</span>"},{"text":"(","startIndex":42,"endIndex":43,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.begin.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">(</span>"},{"text":"samples","startIndex":43,"endIndex":50,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">samples</span>"},{"text":",","startIndex":50,"endIndex":51,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python","punctuation.separator.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">,</span>"},{"text":" ","startIndex":51,"endIndex":52,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\"> </span>"},{"text":"X_test","startIndex":52,"endIndex":58,"scopes":["source.python","meta.function-call.python","meta.function-call.arguments.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">X_test</span>"},{"text":")","startIndex":58,"endIndex":59,"scopes":["source.python","meta.function-call.python","punctuation.definition.arguments.end.python"],"defaultThemeTokenData":{"themeIdentifier":"Default Dark+","className":"mtk1","bold":false,"italic":false,"underline":false,"meta":16793642,"color":"#D4D4D4"},"additionalThemeTokenData":[],"className":"mtk1","html":"<span class=\"mtk1\">)</span>"}],"html":"<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">hmc_y_pred, hmc_y_var = predict_from_chain(samples, X_test)</span></span></span>"}],"id":"c03f0ec2-d737-556f-8f65-de6eda923e17","parent":"c0e1786f-a24c-5cb8-8f6d-ac33c4b0dfed","internal":{"type":"GRVSCCodeBlock","contentDigest":"fa475a5da865aba3c930be9af0114376","counter":1030,"owner":"gatsby-plugin-mdx"},"children":[]}]}